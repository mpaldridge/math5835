<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Solutions – MATH5835M Statistical Computing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../coursework/coursework.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../mystyle.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../problems/solutions.html">Solutions</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MATH5835</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About MATH5835</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Monte Carlo estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L01-mc-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L02-mc-uses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Uses of Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L03-mc-error-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Monte Carlo error I: theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L04-mc-error-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Monte Carlo error II: practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L05-cv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Control variate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L06-antithetic-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Antithetic variables I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/P1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Sheet 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L07-antithetic-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Antithetic variables II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L08-is-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Importance sampling I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L09-is-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Importance sampling II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Random number generation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L10-rng-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Generating random numbers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L11-lcg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">LCGs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/P2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Sheet 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L12-uniform-discrete.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Uniform and discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L13-inverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Inverse transform method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L14-rejection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Rejection sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L15-envelope-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Envelope rejection sampling I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L16-envelope-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Envelope rejection sampling II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/P3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Sheet 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L17-markov-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Markov chains in discrete space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L18-markov-longrun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Markov chains in the long run</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L19-mh-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Metropolis–Hastings in discrete space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L20-markov-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Markov chains in continuous space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L21-mh-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Metropolis–Hastings in continuous space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/P4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Sheet 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L22-mcmc-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">MCMC error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L23-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">MCMC and Bayesian statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Bootstrap</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L24-empirical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Empirical distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L25-plugin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Plug-in estimation &amp; Bootstrap I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L26-bootstrap-error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Bootstrap II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/L27-bootstrap-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Bootstrap III</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/P5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Sheet 5</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../coursework/coursework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computational coursework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../problems/solutions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#P1-sols" id="toc-P1-sols" class="nav-link active" data-scroll-target="#P1-sols">Problem Sheet 1</a></li>
  <li><a href="#P2-sols" id="toc-P2-sols" class="nav-link" data-scroll-target="#P2-sols">Problem Sheet 2</a></li>
  <li><a href="#P3-sols" id="toc-P3-sols" class="nav-link" data-scroll-target="#P3-sols">Problem Sheet 3</a></li>
  <li><a href="#P4-sols" id="toc-P4-sols" class="nav-link" data-scroll-target="#P4-sols">Problem Sheet 4</a></li>
  <li><a href="#P5-sols" id="toc-P5-sols" class="nav-link" data-scroll-target="#P5-sols">Problem Sheet 5</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="solutions" class="quarto-section-identifier">Solutions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="P1-sols" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="P1-sols">Problem Sheet 1</h2>
<div class="hidden">
<p><span class="math display">\[\newcommand{\Exg}{\operatorname{\mathbb{E}}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Ind}{\mathbb{I}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\ee}{\mathrm{e}}\]</span></p>
</div>
<div class="myq">
<p><strong>1.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(X\)</span> be uniform on <span class="math inline">\([-1,2]\)</span>.</p>
<div class="subq">
<p><strong>(a)</strong> &nbsp;&nbsp;By hand, calculate the exact value of <span class="math inline">\(\Ex X^4\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<p><span class="math display">\[\int_{-1}^2 x^4\,\frac{1}{2-(-1)}\,\mathrm{d}x = \tfrac13 \Big[\tfrac15x^5\Big]_{-1}^2 = \tfrac13\Big(\tfrac{32}{5}-\big(-\tfrac15\big)\Big) = \tfrac{33}{15} = \tfrac{11}{5} = 2.2\]</span></p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong> &nbsp;&nbsp;Using R, calculate a Monte Carlo estimate for <span class="math inline">\(\Ex X^4\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> I used the R code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples<span class="sc">^</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.200859</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="myq">
<p><strong>2.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> both be standard normal distributions. Compute a Monte Carlo estimate of <span class="math inline">\(\Exg \max\{X,Y\}\)</span>. (You may wish to investigate R’s <code>pmax()</code> function.)</p>
<div class="myanswers">
<p><em>Solution.</em> By looking at <code>?pmax</code> (or maybe searching on Google) I discovered that <code>pmax()</code> gives the “parallel maxima” of two (or more vectors). That is the first element is the maximum of all the first elements of the vectors; the second element is the maximum of all the second elements of the vectors; and so on.</p>
<p>So I used the R code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>xsamples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ysamples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pmax</span>(xsamples, ysamples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5637339</code></pre>
</div>
</div>
</div>
</div>
<div class="myq">
<p><strong>3.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You are trapped alone on an island. All you have with you is a tin can (radius <span class="math inline">\(r\)</span>) and a cardboard box (side lengths <span class="math inline">\(2r \times 2r\)</span>) that it fits snugly inside. You put the can inside the box [left picture].</p>
<p>When it starts raining, each raindrop that falls in the cardboard box might fall into the tin can [middle picture], or might fall into the corners of the box outside the can [right picture].</p>
<p><img src="P1-can-box.svg" class="img-fluid" width="600"></p>
<div class="subq">
<p><strong>(a)</strong> &nbsp;&nbsp;Using R, simulate rainfall into the box. You may take units such that <span class="math inline">\(r = 1\)</span>. Estimate the probability <span class="math inline">\(\theta\)</span> that a uniformly-random raindrop that falls in the cardboard box falls into the tin can also.</p>
<div class="myanswers">
<p><em>Solution.</em> I set things up so that the box is <span class="math inline">\([-1, 1]^2\)</span>, centered at the origin. This means that the inside of the can is the set of points is those <span class="math inline">\((x,y)\)</span> such that <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rain_x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>rain_y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>in_box <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">in_box</span>(rain_x, rain_y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.785823</code></pre>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong> &nbsp;&nbsp;Calculate exactly the probability <span class="math inline">\(\theta\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> The area of the box is <span class="math inline">\(2r \times 2r = 4r^2\)</span>. The area of the can is <span class="math inline">\(\pi r^2\)</span>. So the probability a raindrop landing in the box lands in the can is <span class="math display">\[ \frac{\text{area of can}}{\text{area of box}} = \frac{\pi r^2}{4r^2} = \frac{\pi}{4} \approx 0.785. \]</span></p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong> &nbsp;&nbsp;You realise that, despite being trapped all alone on the island, you now have a way of approximating the value of <span class="math inline">\(\pi\)</span>. If you want to calculate <span class="math inline">\(\pi\)</span> to 6 decimal places, roughly how many raindrops do you need to fall into the box?</p>
<div class="myanswers">
<p><em>Solution.</em> The phrase “to 6 decimal places” isn’t a precise mathematical one. I’m going to interpret this as getting the root-mean-square error below <span class="math inline">\(10^{-6}\)</span>. If you interpret it slightly differently that’s fine – for example, getting the width of a 95% confidence interval below <span class="math inline">\(10^{-6}\)</span> could be another, slightly stricter, criterion.</p>
<p>One could work this out by hand. Since the variance of a Bernoulli random variable is <span class="math inline">\(p(1-p)\)</span>, the mean-square error of our estimator is <span class="math display">\[ \frac{\frac{\pi}{4}(1 - \frac{\pi}{4})}{n} \approx \frac{0.169}{n} . \]</span> So we need <span class="math display">\[n = \frac{0.169}{(10^{-6})^2} \approx 169 \text{ billion} . \]</span></p>
<p>That said, if we are trapped on our desert island, maybe we don’t know what <span class="math inline">\(\frac{\pi}{4}(1 - \frac{\pi}{4})\)</span> is. In that case we could do this using the can and the box. Our estimate of the variance is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>var_est <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">in_box</span>(rain_x, rain_y))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>var_est <span class="sc">/</span> (<span class="fl">1e-6</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 168305380974</code></pre>
</div>
</div>
<p>We will probably spend a long time waiting for that much rain!</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>4.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(h(x) = 1/(x + 0.1)\)</span>. We wish to estimate <span class="math inline">\(\int_0^5 h(x) \, \mathrm{d}x\)</span> using a Monte Carlo method.</p>
<div class="subq">
<p><strong>(a)</strong> &nbsp;&nbsp;Estimate the integral using <span class="math inline">\(X\)</span> uniform on <span class="math inline">\([0,5]\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">/</span> (x <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">5</span> <span class="sc">*</span> <span class="fu">integrand</span>(samples1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.929335</code></pre>
</div>
</div>
<p>(In fact, the true answer is <span class="math inline">\(\log(5.1) - \log(0.1) = 3.932\)</span>, so it looks like this is working correctly.)</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong> &nbsp;&nbsp;Can you come up with a choice of <span class="math inline">\(X\)</span> that improves on the estimate from (a)?</p>
<div class="myanswers">
<p><em>Solution.</em> Let’s look at a graph of the integrand <span class="math inline">\(h\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code for drawing this graph</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  integrand, <span class="at">n =</span> <span class="dv">1001</span>, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"integrand h(x)"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/h2-graph-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that we get a much bigger contribution to the integral from values near 0. So a random variable that picks values nearer to 0 more often might have a chance of giving a more accurate result.</p>
<!--*(I now have a bit of admission to make. I set this question before actually checking the answers. When I came to solve this problem, I found it surprisingly difficult to beat the uniform distribution! If you tried another distribution, and seemed to get an estimate near 3.93, you should consider that a good enough answer to this question -- even if the mean-square error was quite large.)*-->
<p>I decided to try an exponential distribution with rate 1, which should sample the smaller values of <span class="math inline">\(x\)</span> more often.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dexp</span>(x, <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (<span class="fu">integrand</span>(x) <span class="sc">/</span> <span class="fu">pdf</span>(x)) <span class="sc">*</span> (x <span class="sc">&lt;=</span> <span class="dv">5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">phi</span>(samples2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.935744</code></pre>
</div>
</div>
<p>(I had to include <code>x &lt;= 5</code> in the expression for <span class="math inline">\(\phi\)</span>, because my exponential distribution will sometimes take samples above 5, but they should count as 0 in an estimate for the integral between 0 and 5.)</p>
<p>To see whether or not this was an improvement, I estimated the mean-square error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="dv">5</span> <span class="sc">*</span> <span class="fu">integrand</span>(samples1)) <span class="sc">/</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.361979e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="fu">phi</span>(samples2)) <span class="sc">/</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.073885e-06</code></pre>
</div>
</div>
<p>I found that I had reduced the mean-square error by roughly a factor of 5. <!--


::: {.cell}

```{.r .cell-code  code-summary="Code for drawing this graph"}
pdf <- function(x) dbeta(x / 5, 1, 2) / 5
phi <- function(x) integrand(x) / pdf(x)

samples2 <- 5 * rbeta(n, 1, 2)
mean(phi(samples2))
```

::: {.cell-output .cell-output-stdout}

```
[1] 3.931375
```


:::
:::


--></p>
</div>
</div>
</div>
<div class="myq">
<p><strong>5.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When calculating a Monte Carlo estimate <span class="math inline">\(\frac{1}{n} \sum_{i=1}^n \phi(x_i)\)</span>, one might wish to first generate the <span class="math inline">\(n\)</span> samples <span class="math inline">\((x_1, x_2, \dots, x_n)\)</span> and store them, and only then, after all samples are generated, finally calculate the estimate. However, when <span class="math inline">\(n\)</span> is extremely large, storing all <span class="math inline">\(n\)</span> samples uses up a lot of space in a computer’s memory. Describe (in words, in R code, or in a mixture of the two) how the Monte Carlo estimate could be produced using much less memory.</p>
<div class="myanswers">
<p><em>Solution.</em> The idea is to keep a “running total” of the <span class="math inline">\(\phi(x_i)\)</span>s. Then we only have to store that running total, not all the samples. Once this has been done <span class="math inline">\(n\)</span> times, then divide by <span class="math inline">\(n\)</span> to get the estimate.</p>
<p>In R code, this might be something like</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="co"># sampling code for 1 sample</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="fu">phi</span>(sample)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>MCest <span class="ot">&lt;-</span> total <span class="sc">/</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="myq">
<p><strong>6.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Show that the indicator functions <span class="math inline">\(\mathbb I_A(X)\)</span> and <span class="math inline">\(\mathbb I_B(X)\)</span> have correlation 0 if and only if the events <span class="math inline">\(\{X \in A\}\)</span> and <span class="math inline">\(\{X \in B\}\)</span> are independent.</p>
<div class="myanswers">
<p><em>Solution.</em> Recall that two random variables <span class="math inline">\(U\)</span>, <span class="math inline">\(V\)</span> have correlation 0 if and only if their covariance <span class="math inline">\(\Cov(U,V) = \Ex UV - (\Ex U)(\Ex V)\)</span> is 0 too.</p>
<p>We know that <span class="math inline">\(\Exg\Ind_A(X) = \mathbb P(X \in A)\)</span> and <span class="math inline">\(\Exg \Ind_B(Y) = \mathbb P(X \in B)\)</span>. What about <span class="math inline">\(\Exg \Ind_A(X) \Ind_B(X)\)</span>? Well, <span class="math inline">\(\Ind_A(x) \Ind_B(x)\)</span> is 1 if and only if <em>both</em> indicator functions equal 1, which is if and only if both <span class="math inline">\(x \in A\)</span> and <span class="math inline">\(x \in B\)</span>. So <span class="math inline">\(\Exg \Ind_A(X) \Ind_B(X) = \mathbb P(X \in A \text{ and } X \in B)\)</span>.</p>
<p>So the covariance is <span class="math display">\[ \Cov \big(\Ind_A(X), \Ind_B(X) \big) = \mathbb P(X \in A \text{ and } X \in B) - \mathbb P(X \in A)\, \mathbb P(X \in B) . \]</span> If this is 0, then <span class="math inline">\(\mathbb P(X \in A \text{ and } X \in B) = \mathbb P(X \in A)\, \mathbb P(X \in B)\)</span>, which is precisely the definition of those two events being independent.</p>
</div>
</div>
<div class="myq">
<p><strong>7.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(X\)</span> be an exponential distribution with rate 1.</p>
<div class="subq">
<p><strong>(a)</strong> &nbsp;&nbsp;Estimate <span class="math inline">\(\mathbb EX^{2.1}\)</span> using the standard Monte Carlo method.</p>
<div class="myanswers">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples<span class="sc">^</span><span class="fl">2.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.204066</code></pre>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong> &nbsp;&nbsp;Estimate <span class="math inline">\(\mathbb EX^{2.1}\)</span> using <span class="math inline">\(X^2\)</span> as a control variate. (You may recall that if <span class="math inline">\(Y\)</span> is exponential with rate <span class="math inline">\(\lambda\)</span> then <span class="math inline">\(\mathbb EY^2 = 2/\lambda^2\)</span>.)</p>
<div class="myanswers">
<p><em>Solution.</em> We have <span class="math inline">\(\Ex X^2 = 2\)</span>. So, re-using the same sample as before (you don’t have to do this – you could take new samples), our R code is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples<span class="sc">^</span><span class="fl">2.1</span> <span class="sc">-</span> samples<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.198793</code></pre>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong> &nbsp;&nbsp;Which method is better?</p>
<div class="myanswers">
<p><em>Solution.</em> The better answer is the one with the smaller mean-square error.</p>
<p>For the basic method,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(samples<span class="sc">^</span><span class="fl">2.1</span>) <span class="sc">/</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.82498e-05</code></pre>
</div>
</div>
<p>For the control variate method,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(samples<span class="sc">^</span><span class="fl">2.1</span> <span class="sc">-</span> samples<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.958636e-07</code></pre>
</div>
</div>
<p>So the control variates method is much, much better.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>8.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(Z\)</span> be a standard normal distribution. A statistician has been investigating Monte Carlo estimates of <span class="math inline">\(\mathbb EZ^k\)</span> for different positive integers values of <span class="math inline">\(k\)</span>. Her colleague suggests using <span class="math inline">\(Z' = -Z\)</span> as an antithetic variable. Without running any R code, explain whether or not this is a good idea <strong>(a)</strong> when <span class="math inline">\(k\)</span> is even; <strong>(b)</strong> when <span class="math inline">\(k\)</span> is odd.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<p><strong>(a)</strong> When <span class="math inline">\(k\)</span> is even, we have <span class="math inline">\(Z^k = (-Z)^k\)</span>. So the antithetic variables method just repeats each sample twice. This is obviously no benefit at all, and just wastes time. Indeed, we have perfect positive correlation <span class="math inline">\(\rho = +1\)</span>, which is the “worst-case scenario”.</p>
<p><strong>(b)</strong> When <span class="math inline">\(k\)</span> is odd, we have <span class="math inline">\(Z^k = -(-Z)^k\)</span>. In this case we know that <span class="math inline">\(\Ex Z^k = 0\)</span>, because the results for positive <span class="math inline">\(z\)</span> exactly balance out those for negative <span class="math inline">\(z\)</span>, so no Monte Carlo sampling is necessary. If our statistician has somehow forgotten that, though, she will get a pleasant surprise! After just two samples, she will get the estimate <span class="math display">\[\frac{1}{2} \big(Z_1^k + (-Z_1)^k \big) = \frac{1}{2} (Z_1^k - Z_1^k) = 0 ,\]</span> Thereby getting the result exactly right. Indeed, we have perfect negative correlation <span class="math inline">\(\rho = -1\)</span>, which is the “best-case scenario”.</p>
</div>
</div>
</section>
<section id="P2-sols" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="P2-sols">Problem Sheet 2</h2>
<div class="hidden">
<p><span class="math display">\[\newcommand{\Exg}{\operatorname{\mathbb{E}}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Ind}{\mathbb{I}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\ee}{\mathrm{e}}\]</span></p>
</div>
<div class="myq">
<p><strong>1.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>[2018 exam, Question 4]</em></p>
<div class="subq">
<p><strong>(a)</strong> &nbsp;&nbsp;Suppose it is desired to estimate the value of an integral <span class="math display">\[ \theta = \int_0^1 h(x)\,\mathrm{d}x \]</span> by Monte Carlo integration</p>
<div class="subq">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>i.</strong>&nbsp;&nbsp;&nbsp;By splitting <span class="math inline">\(h(x) = \phi(x)f(x)\)</span>, where <span class="math inline">\(f\)</span> is a probability density function, describe how the Monte Carlo method of estimating <span class="math inline">\(\theta\)</span> works.</p>
<div class="myanswers">
<p><em>Solution.</em> As suggested, we have <span class="math display">\[ \theta = \int_0^1 h(x)\,\mathrm{d}x = \int_0^1 \phi(x)\,f(x)\,\mathrm{d}x = \Exg \phi(X) ,\]</span> where <span class="math inline">\(X\)</span> is a random variable with PDF <span class="math inline">\(f\)</span>. To estimate this, we sample <span class="math inline">\(X_1, \dots, X_n\)</span> from <span class="math inline">\(X\)</span>, and use <span class="math display">\[ \widehat\theta_n^{\mathrm{MC}} = \frac{1}{n} \sum_{i=1}^n \phi(X_i) . \]</span></p>
</div>
</div>
<div class="subq">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ii.</strong>&nbsp;&nbsp;Let <span class="math inline">\(\widehat\theta_n\)</span> be the Monte Carlo estimate based on <span class="math inline">\(n\)</span> simulations. Find the expectation and variance of <span class="math inline">\(\widehat\theta_n\)</span>, as a function of <span class="math inline">\(n\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> As in lectures, we have <span class="math display">\[ \Exg \theta_n^{\mathrm{MC}} = \Ex \left(\frac{1}{n} \sum_{i=1}^n \phi(X_i) \right) = \frac{1}{n}\,n\Exg\phi(X) = \Exg\phi(X) \]</span> and <span class="math display">\[ \Var\big((\theta_n^{\mathrm{MC}}\big) = \Var \left(\frac{1}{n} \sum_{i=1}^n \phi(X_i) \right) = \frac{1}{n^2}\,n\Var\big(\phi(X)\big) = \frac{1}{n}\Var\big(\phi(X)\big) . \]</span></p>
</div>
</div>
<div class="subq">
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>iii.</strong>&nbsp;&nbsp;What guidelines can be given for the choice of <span class="math inline">\(f\)</span> in practice?</p>
<div class="myanswers">
<p><em>Solution.</em> First, <span class="math inline">\(f\)</span> (or equivalently <span class="math inline">\(X\)</span>) should be easy to sample from. Second, we want to minimise <span class="math inline">\(\Var(\phi(X))\)</span>, so should pick <span class="math inline">\(f\)</span> approximately proportional to <span class="math inline">\(h\)</span>, so that <span class="math inline">\(\phi\)</span> is roughly constant, and therefore has low variance.</p>
<p>In the absence of better options, <span class="math inline">\(X\)</span> being uniform on <span class="math inline">\([0, 1]\)</span> (so <span class="math inline">\(f(x) = 1\)</span> on this interval) is often not a bad choice.</p>
</div>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Consider evaluation the integral <span class="math display">\[ \int_0^1 x^2\,\mathrm{d}x \]</span> by Monte Carlo integration using <span class="math inline">\(f(x) = \Ind_{[0,1]}(x)\)</span>. Write down the Monte Carlo estimator <span class="math inline">\(\widehat\theta_n\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> Since <span class="math inline">\(f(x) = 1\)</span> on this interval, we must take <span class="math inline">\(\phi(x) = x^2\)</span>. Thus the estimator is <span class="math display">\[\widehat\theta_n = \frac{1}{n} \sum_{i=1}^n X_i^2 ,\]</span> where <span class="math inline">\(X_i \sim \operatorname{U}[0,1]\)</span> are independent.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Explain how antithetic variables can be used in this situation, and justify briefly why their use here is guaranteed to improve efficiency.</p>
<div class="myanswers">
<p><em>Solution.</em> Antithetic variables attempt to reduce the variance in Monte Carlo estimation by using pairs of variables <span class="math inline">\((X_i, X'_i)\)</span> that both have the same distribution as <span class="math inline">\(X\)</span>, but where <span class="math inline">\(\phi(X)\)</span> and <span class="math inline">\(\phi(X')\)</span> are negatively correlated.</p>
<p>In this situation, if <span class="math inline">\(X_i \sim \operatorname{U}[0,1]\)</span>, then <span class="math inline">\(X'_i = 1 - X_i\)</span> has this same distribution. The corresponding antithetic variable estimator is <span class="math display">\[\widehat\theta_n^{\mathrm{AV}} = \frac{1}{n} \sum_{i=1}^{n/2} \big(X_i^2 + (1 - X_i)^2\big) .\]</span></p>
<p>An anitithetic variables estimator always decreases the variance of a Monte Carlo estimator if the correlation (or, equivalently, the covariance) between <span class="math inline">\(\phi(X)\)</span> and <span class="math inline">\(\phi(X')\)</span> is negative. We saw in lectures that, if <span class="math inline">\(X \sim \operatorname{U}[0,1]\)</span> and <span class="math inline">\(\phi\)</span> is monotonically increasing, then <span class="math inline">\(\phi(X)\)</span> and <span class="math inline">\(\phi(1 - X)\)</span> have negative correlation. Since <span class="math inline">\(x^2\)</span> is increasing on <span class="math inline">\([0,1]\)</span>, that is the case here.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For <span class="math inline">\(U \sim \operatorname{U}[0,1]\)</span>, use the results <span class="math display">\[\Ex U^2 = \tfrac13 \qquad \Ex U^4 = \tfrac15 \qquad \Ex U^2(1-U)^2 = \tfrac{1}{30} \]</span> to find the correlation between <span class="math inline">\(U^2\)</span> and <span class="math inline">\((1-U)^2\)</span>. Hence, or otherwise, confirm that using antithetic variables reduces the variance of the Monte Carlo estimator by a factor of 8.</p>
<div class="myanswers">
<p><em>Solution.</em> We need to find the correlation between <span class="math inline">\(U^2\)</span> and <span class="math inline">\((1 - U)^2\)</span>, where <span class="math inline">\(U \sim \operatorname{U}[0,1]\)</span>. The covariance is <span class="math display">\[ \operatorname{Cov}\big(U^2, (1-U)^2\big)
= \Ex U^2(1-U)^2 - \big(\Ex U^2\big) \big(\Ex (1-U)^2\big)
= \tfrac{1}{30} - \Big(\tfrac{1}{3}\Big)^2 = -\tfrac{7}{90} .\]</span> The variance are both <span class="math display">\[ \Var(U^2) = \Ex U^4 - \big(\Ex U^2\big)^2 = \tfrac15 - \Big(\tfrac{1}{3}\Big)^2 = \tfrac{4}{45} . \]</span> Hence, the correlation is <span class="math display">\[ \rho = \operatorname{Corr}\big(U^2, (1-U)^2\big) = \frac{-\frac{7}{90}}{\frac{4}{45}} = -\tfrac78 . \]</span></p>
<p>The variance of the standard Monte Carlo estimator is <span class="math inline">\(\frac{1}{n}\Var(\phi(X))\)</span>, while the variance of the antithetic variables estimator is <span class="math inline">\(\frac{1+\rho}{n}\Var(\phi(X))\)</span>. So the variance changes by a factor of <span class="math inline">\(1 + \rho\)</span>, which here is <span class="math inline">\(1 - \frac{7}{8} = \frac{1}{8}\)</span>. So the variance reduces by a factor of 8, as claimed.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(You may use without proof any results about the variance of antithetic variable estimates, but you should clearly state any results you are using.)</p>
</div>
</div>
<div class="myq">
<p><strong>2.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(X \sim \operatorname{N}(0,1)\)</span>. Consider importance sampling estimation for the probability <span class="math inline">\(\theta = \mathbb P(3 \leq X \leq 4)\)</span> using samples <span class="math inline">\(Y_i\)</span> from the following sample distributions: <strong>(i)</strong> <span class="math inline">\(Y \sim \operatorname{N}(1,1)\)</span>; <strong>(ii)</strong> <span class="math inline">\(Y \sim \operatorname{N}(2,1)\)</span>; <strong>(iii)</strong>&nbsp;<span class="math inline">\(Y \sim \operatorname{N}(3.5,1)\)</span>; <strong>(iv)</strong> <span class="math inline">\(Y \sim 3 + \operatorname{Exp}(1)\)</span>.</p>
<p>Each of these four distributions gives rise to a different importance sampling method. Our aim is to compare the resulting estimates.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;For each of the four methods, estimate the variance <span class="math inline">\(\Var\big(\frac{f(Y)}{g(Y)}\,\phi(Y)\big)\)</span>. Which of these four methods gives the best results?</p>
<div class="myanswers">
<p><em>Solution.</em> I used the following R code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>phi   <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">&amp;</span> (x <span class="sc">&lt;=</span> <span class="dv">4</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>pdf_x <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>pdf_y1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>samples_y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">pdf_x</span>(samples_y1) <span class="sc">/</span> <span class="fu">pdf_y1</span>(samples_y1)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y1))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>pdf_y2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>samples_y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">pdf_x</span>(samples_y2) <span class="sc">/</span> <span class="fu">pdf_y2</span>(samples_y2)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y2))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>pdf_y3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="fl">3.5</span>, <span class="dv">1</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>samples_y3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="fl">3.5</span>, <span class="dv">1</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">pdf_x</span>(samples_y3) <span class="sc">/</span> <span class="fu">pdf_y3</span>(samples_y3)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y3))</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>pdf_y4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dexp</span>(x <span class="sc">-</span> <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>samples_y4 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>var4 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">pdf_x</span>(samples_y4) <span class="sc">/</span> <span class="fu">pdf_y4</span>(samples_y4)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y4))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="fu">signif</span>(<span class="fu">c</span>(var1, var2, var3, var4), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.20e-05 1.39e-05 6.69e-06 1.92e-06</code></pre>
</div>
</div>
<p>(For the fourth PDF, we used that the PDF of <span class="math inline">\(3 + Z\)</span> is <span class="math inline">\(f_Z(z-3)\)</span>.)</p>
<p>We see that the fourth method <span class="math inline">\(3 + \operatorname{Exp}(1)\)</span> is the most accurate.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Determine a good estimate for <span class="math inline">\(\mathbb P(3 \leq X \leq 4)\)</span>, and discuss the accuracy of your estimate.</p>
<div class="myanswers">
<p><em>Solution.</em> We’ll use the fourth method, and boost the number of samples to one million.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ISest <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">pdf_x</span>(samples_y4) <span class="sc">/</span> <span class="fu">pdf_y4</span>(samples_y4)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y4))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>IS_MSE <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">pdf_x</span>(samples_y4) <span class="sc">/</span> <span class="fu">pdf_y4</span>(samples_y4)) <span class="sc">*</span> <span class="fu">phi</span>(samples_y4)) <span class="sc">/</span> n</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(ISest, <span class="fu">sqrt</span>(IS_MSE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.316356e-03 1.387238e-06</code></pre>
</div>
</div>
<p>So our estimate is <span class="math inline">\(\widehat\theta = 0.00132\)</span>. Since the RMSE is three orders of magnitude less than the estimate, so the estimate is probably accurate to a couple of significant figures.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;For each of the four methods, approximate how many samples from <span class="math inline">\(Y\)</span> are required to reduce the root-mean-square error of the estimate of <span class="math inline">\(\mathbb P(3 \leq X \leq 4)\)</span> to 1%?</p>
<div class="myanswers">
<p><em>Solution.</em> To get the error to 1% means an absolute error of roughly <span class="math inline">\(\epsilon = 0.01\widehat\theta\)</span>. Then we know that the required number of samples is <span class="math display">\[ n = \frac{\Var\big(\frac{f(Y)}{g(Y)}\phi(Y)\big)}{\epsilon^2} . \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="sc">*</span> ISest</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(var1, var2, var3, var4) <span class="sc">/</span> eps<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 473334  80024  38607  11106</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="myq">
<p><strong>3.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>[2017 exam, Question 3]</em></p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Defining any notation you use, write down the basic Monte Carlo estimator <span class="math inline">\(\widehat\theta_n^{\mathrm{MC}}\)</span> and the importance sampling estimator <span class="math inline">\(\widehat\theta_n^{\mathrm{IS}}\)</span> for an expectation of the form <span class="math inline">\(\theta = \Exg \phi(X)\)</span>, where <span class="math inline">\(X\)</span> is a random variable with probability density function <span class="math inline">\(f\)</span>.</p>
<p>What is the advantage of importance sampling over the standard Monte Carlo method?</p>
<div class="myanswers">
<p><em>Solution.</em> The basic Monte Carlo estimator is <span class="math display">\[ \widehat\theta_n^{\mathrm{MC}} = \frac{1}{n} \sum_{i=1}^n\phi(X_i) , \]</span> where the <span class="math inline">\(X_i\)</span> are independent random samples from <span class="math inline">\(X\)</span>.</p>
<p>The basic importance sampling estimator is <span class="math display">\[ \widehat\theta_n^{\mathrm{IS}} = \frac{1}{n} \sum_{i=1}^n \frac{f(Y_i)}{g(Y_i)} \,\phi(Y_i) , \]</span> where the <span class="math inline">\(Y_i\)</span> are independent random samples from a random variable <span class="math inline">\(Y\)</span> with probability density function <span class="math inline">\(g\)</span>. We must have <span class="math inline">\(g(y) &gt; 0\)</span> whenever <span class="math inline">\(f(y) &gt; 0\)</span>.</p>
<p>The main advantage of the importance sampling estimator is that can reduce the variance of the estimator by oversampling the most important areas of <span class="math inline">\(y\)</span>, but then downweighting those samples. Another advantage is that importance sampling can be used when it is difficult to sample from <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Prove that both the basic Monte Carlo and importance sampling estimates from part (a) are unbiased.</p>
<div class="myanswers">
<p><em>Solution.</em> For the standard Monte Carlo estimator, <span class="math display">\[ \Exg \theta_n^{\mathrm{MC}} = \Ex \left(\frac{1}{n} \sum_{i=1}^n \phi(X_i) \right) = \frac{1}{n}\,n\Exg\phi(X) = \Exg\phi(X) = \theta .\]</span></p>
<p>For the importance sampling estimator, first note that <span class="math display">\[ \mathbb E \left(\frac{f(Y)}{g(Y)}\,\phi(Y)\right) = \int_{-\infty}^{+\infty} \frac{f(y)}{g(y)}\,\phi(y)\,g(y)\,\mathrm{d}y = \int_{-\infty}^{+\infty} \phi(y) \,f(y) \, \mathrm{d}y = \Exg\phi(X)  , \]</span> since <span class="math inline">\(f\)</span> is the PDF of <span class="math inline">\(X\)</span>. Hence <span class="math display">\[ \Exg \widehat\theta_n^{\mathrm{IS}} = \Exg \left(\frac{1}{n} \sum_{i=1}^n \frac{f(Y_i)}{g(Y_i)} \,\phi(Y_i) \right) = \frac{1}{n}\,n\,\Ex \left(\frac{f(Y)}{g(Y)}\,\phi(Y)\right) = \Exg \phi(X) = \theta. \]</span></p>
<p>Hence, both estimators are unbiased.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Show that the variance of the importance sampling estimator is given by <span class="math display">\[ \Var\big(\widehat\theta_n^{\mathrm{IS}}\big) = \frac{1}{n}\int_{-\infty}^{+\infty} \frac{f(y)^2 \phi(y)^2}{g(y)}\,\mathrm{d}y - \frac{1}{n}\big(\Exg \phi(X)\big)^2. \]</span></p>
<div class="myanswers">
<p><em>Solution.</em> First, note that <span class="math display">\[\begin{align} \Var \left(\frac{f(Y)}{g(Y)}\,\phi(Y)\right)
&amp;= \Ex \left(\frac{f(Y)}{g(Y)}\,\phi(Y)\right)^2 - \big(\Exg \phi(X)\big)^2 \\
&amp;= \int_{-\infty}^{+\infty} \left(\frac{f(y)}{g(y)}\,\phi(y)\right)^2 g(y)\,\mathrm{d}y  - \big(\Exg \phi(X)\big)^2\\
&amp;= \int_{-\infty}^{+\infty} \frac{f(y)^2}{g(y)^2}\,\phi(y)^2 \,g(y)\,\mathrm{d}y  - \big(\Exg \phi(X)\big)^2\\
&amp;= \int_{-\infty}^{+\infty} \frac{f(y)^2}{g(y)}\,\phi(y)^2 \,\mathrm{d}y  - \big(\Exg \phi(X)\big)^2 \end{align} \]</span> Second, we have <span class="math display">\[ \Var\big(\widehat\theta_n^{\mathrm{IS}}\big) = \Var \left(\frac{1}{n} \sum_{i=1}^n \frac{f(Y_i)}{g(Y_i)} \,\phi(Y_i) \right) = \frac{1}{n} \Var \left(\frac{f(Y)}{g(Y)}\,\phi(Y)\right) . \]</span> Putting these together proves the result.</p>
</div>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;Let <span class="math inline">\(X \sim \operatorname{N}(0,2)\)</span> and <span class="math inline">\(a \in \mathbb R\)</span>. We want to estimate <span class="math inline">\(\theta = \Ex \big(\sqrt{2}\exp(-(X-a)^2/4)\big)\)</span>, using importance sampling with samples <span class="math inline">\(Y \sim \operatorname{N}(\mu, 1)\)</span> for some <span class="math inline">\(\mu \in \mathbb R\)</span>. Using the result from part (c), or otherwise, show that in the case the variance of the importance sampling estimator <span class="math inline">\(\widehat\theta_n^{\mathrm{IS}}\)</span> is given by <span class="math display">\[ \Var\big(\widehat\theta_n^{\mathrm{IS}}\big) = \frac{\exp(\mu^2 - a\mu) - \theta^2}{n} . \]</span> <em>[Note: This equation has changed since an earlier version of the question.]</em></p>
<div class="myanswers">
<p><em>Solution.</em> It’s clear, using part (c), that it will suffice to show that <span class="math display">\[ \int_{-\infty}^{+\infty} \frac{f(y)^2 \phi(y)^2}{g(y)}\,\mathrm{d}y = \exp(\mu^2 - a\mu) . \]</span> Here, we have <span class="math display">\[ \begin{align}
f(y) &amp;= \frac{1}{\sqrt{4\pi}} \exp\big(-\tfrac14 y^2 \big) \\
g(y) &amp;= \frac{1}{\sqrt{2\pi}} \exp\big(-\tfrac12 (y-\mu)^2 \big) \\
\phi(y) &amp;= \sqrt{2} \exp\big(-\tfrac14 (y-a)^2 \big) .
\end{align} \]</span> Therefore, by a long and painful algebra slog, we have <span class="math display">\[ \begin{align}
\frac{f(y)^2 \phi(y)^2}{g(y)} &amp;= \frac{\frac{1}{4\pi} \exp\big(-\tfrac12 y^2 \big)\times 2\exp\big(-\tfrac12 (y-a)^2 \big)}{\frac{1}{\sqrt{2\pi}} \exp\big(-\tfrac12 (y-\mu)^2 \big)} \\
&amp;= \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big(y^2 + (y-a)^2 - (y-\mu)^2 \big)\Big) \\
&amp;= \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big(y^2 - 2(a - \mu)y + a^2 + \mu^2\big)\Big) \\
&amp;= \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big((y - (a - \mu))^2 - (a- \mu)^2 + a^2 - \mu^2\big)\Big) \\
&amp;= \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big((y - (a - \mu))^2 + 2a\mu - 2\mu^2 \big)\Big) \\
&amp;=  \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big(y - (a - \mu)\big)^2\Big)\exp(\mu^2 + a\mu),
\end{align} \]</span> where we ‘completed the square’ on the fourth line. Thus <span class="math display">\[ \begin{align}
\int_{-\infty}^{+\infty} \frac{f(y)^2 \phi(y)^2}{g(y)}\,\mathrm{d}y
&amp;= \int_{-\infty}^{+\infty}  \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big(y - (a - \mu)\big)^2\Big)\exp(\mu^2 + 2a) \,\mathrm{d}y\\
&amp;= \exp(\mu^2 + 2a) \int_{-\infty}^{+\infty}  \frac{1}{\sqrt{2\pi}} \exp \Big(-\tfrac12 \big(y - (a - \mu)\big)^2\Big)\,\mathrm{d}y \\
&amp;= \exp(\mu^2 + a\mu) ,
\end{align} \]</span> since the big integral on the right is the integral of the PDF of a normal <span class="math inline">\(\operatorname{N}(a-\mu, 1)\)</span> distribution, so equals 1.</p>
<p>Hence, we have proved the result.</p>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For fixed <span class="math inline">\(n\)</span> and <span class="math inline">\(a\)</span>, find the value of <span class="math inline">\(\mu\)</span> for which the importance sampling estimator has the smallest mean-square error. Comment on the result.</p>
<div class="myanswers">
<p><em>Solution.</em> Minimising this expression is equivalent to minimising <span class="math inline">\(\mu^2 + a\mu\)</span>. By differentiating with respect to <span class="math inline">\(\mu\)</span> (or otherwise), we see that this is at <span class="math inline">\(a = \tfrac12 \mu\)</span>.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Answer the following question “by hand”, without using R. You may <em>check</em> your answer with R, if you wish.)</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Consider the LCG with modulus <span class="math inline">\(m = 2^4 = 16\)</span>, multiplier <span class="math inline">\(a = 5\)</span>, and increment <span class="math inline">\(a = 8\)</span>. What is the period of this LCG when started from the seed <strong>(i)</strong> <span class="math inline">\(x_1 = 1\)</span>; <strong>(ii)</strong> <span class="math inline">\(x_1 = 2\)</span>?</p>
<div class="myanswers">
<p><em>Solution.</em> For <strong>(i)</strong>, we have <span class="math display">\[ \begin{align}
x_1 &amp;= 1 \\
x_2 &amp;= (5 \times 1 + 8) \bmod 16 = 13 \bmod 16 = 13 \\
x_3 &amp;= (5 \times 13 + 8) \bmod 16 = 73 \bmod 16 = 9 \\
x_4 &amp;= (5 \times 9 + 8) \bmod 16 = 53 \bmod 16 = 5 \\
x_5 &amp;= (5 \times 5 + 8) \bmod 16 = 33 \bmod 16 = 1 .
\end{align}\]</span> Here, <span class="math inline">\(x_5\)</span> is a repeat of <span class="math inline">\(x_1\)</span>, so the period is <span class="math inline">\(5-1=4\)</span>.</p>
<p>For <strong>(ii)</strong>, we have <span class="math display">\[ \begin{align}
x_1 &amp;= 2 \\
x_2 &amp;= (5 \times 2 + 8) \bmod 16 = 18 \bmod 16 = 2 .
\end{align}\]</span> This is an immediate repeat, so the period is 2.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong> Consider the LCG with modulus <span class="math inline">\(m = 2^4 = 16\)</span>, multiplier <span class="math inline">\(a = 2\)</span>, and increment <span class="math inline">\(c = 4\)</span>. Start from the seed <span class="math inline">\(x_1 = 3\)</span>. <strong>(i)</strong> When do we first see a repeat output? <strong>(ii)</strong> What is the period?</p>
<div class="myanswers">
<p><em>Solution.</em> We have <span class="math display">\[ \begin{align}
x_1 &amp;= 3 \\
x_2 &amp;= (2 \times 3 + 4) \bmod 16 = 10 \bmod 16 = 10 \\
x_3 &amp;= (2 \times 10 + 4) \bmod 16 = 24 \bmod 16 = 8 \\
x_4 &amp;= (2 \times 8 + 4) \bmod 16 = 20 \bmod 16 = 4 \\
x_5 &amp;= (2 \times 4 + 4) \bmod 16 = 12 \bmod 16 = 12 \\
x_6 &amp;= (2 \times 12 + 4) \bmod 16 = 28 \bmod 16 = 12 .
\end{align}\]</span></p>
<p><strong>(i)</strong> The first repeat is <span class="math inline">\(x_6\)</span>.</p>
<p><strong>(ii)</strong> Since 12 is a fixed point of this LCG, the remainder of the sequence is 12 forever, with period 1.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>5.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider the following LCGs with modulus <span class="math inline">\(m = 2^8 = 256\)</span>:</p>
<p>&nbsp;(i) <span class="math inline">\(a = 31\)</span>, <span class="math inline">\(c = 47\)</span>;</p>
<p>&nbsp;(ii) <span class="math inline">\(a = 21\)</span>, <span class="math inline">\(c = 47\)</span>;</p>
<p>&nbsp;(iii) <span class="math inline">\(a = 129\)</span>, <span class="math inline">\(c = 47\)</span>.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Without using a computer, work out which of these LCGs have a full period of 256.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<p>&nbsp;(i) Here, <span class="math inline">\(a\)</span> is <span class="math inline">\(3 \bmod 4\)</span>, not <span class="math inline">\(1 \bmod 4\)</span>, so this does not have full period of 256.</p>
<p>&nbsp;(ii) Here, <span class="math inline">\(c\)</span> is odd and <span class="math inline">\(a\)</span> is <span class="math inline">\(1 \bmod 4\)</span>, so this does have full period of 256.</p>
<p>&nbsp;(iii) Here, <span class="math inline">\(c\)</span> is odd and <span class="math inline">\(a\)</span> is <span class="math inline">\(1 \bmod 4\)</span>, so this does have full period of 256.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Which of these LCGs would make good pseudorandom number generators?</p>
<div class="myanswers">
<p><em>Solution.</em> We will check the random appearance of the outputs using R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lcg <span class="ot">&lt;-</span> <span class="cf">function</span>(n, modulus, mult, incr, seed) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> seed</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    samples[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (mult <span class="sc">*</span> samples[i] <span class="sc">+</span> incr) <span class="sc">%%</span> modulus</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;(i) This does not have full period, so is unlikely to be good PRNG. Let’s check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">8</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lcg</span>(m, m, <span class="dv">31</span>, <span class="dv">47</span>, seed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The picture confirms that this does not look random, and in fact has very short period of 16.</p>
<p>&nbsp;(ii) This does have full period, so is a candidate for a good PRNG if the output looks random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lcg</span>(m, m, <span class="dv">21</span>, <span class="dv">47</span>, seed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-19-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This mostly looks random, but there does appear to be a sort of thick diagonal line in the picture going from bottom left to rop right. I’d might be happy to use this for casual statistical work – the lack of randomness does not seem super-serious – but I would avoid this for cryptographic purposes, for example.</p>
<p>&nbsp;(iii) This does have full period, so is a candidate for a good PRNG if the output looks random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lcg</span>(m, m, <span class="dv">129</span>, <span class="dv">47</span>, seed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-20-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Even though this has full period, there is a very clear non-random pattern. This is not appropriate for a PRNG.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>6.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider an LCG with modulus <span class="math inline">\(m = 2^{10} = 1024\)</span>, multiplier <span class="math inline">\(a = 125\)</span>, and increment <span class="math inline">\(c = 5\)</span>. Using R:</p>
<div class="subq">
<p><strong>(a)</strong> Generate 1000 outputs in <span class="math inline">\(\{0, 1, \dots, 1023\}\)</span> from this LCG, starting with the seed <span class="math inline">\(x_1 = 1\)</span>.</p>
<p><em>[This question originally said 200 outputs, not 1000. It’s fine if you answered that version, but the conclusions to the problem are less interesting that way.]</em></p>
<div class="myanswers">
<p><em>Solution.</em> Using the same <code>lcg()</code> function from Question 5, we have</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>{<span class="dv">10</span>}</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> <span class="fu">lcg</span>(n, m, <span class="dv">125</span>, <span class="dv">5</span>, seed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Convert these to 1000 outputs to pseudorandom uniform samples in <span class="math inline">\([0, 1]\)</span>.</p>
<div class="myanswers">
<p>To do this, we simply divide the samples by <span class="math inline">\(m\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> samples1 <span class="sc">/</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Using these samples, obtain a Monte Carlo estimate for <span class="math inline">\(\mathbb E\cos(U)\)</span>, where <span class="math inline">\(U \sim \operatorname{U}[0,1]\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">cos</span>(samples1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8418218</code></pre>
</div>
</div>
<p>This is very close to the correct answer <span class="math inline">\(\sin 1 = 0.8414\)</span></p>
</div>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;What is the root-mean-square error of your estimate?</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">cos</span>(samples1)) <span class="sc">/</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004392217</code></pre>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(e)</strong>&nbsp;&nbsp;Repeat parts (a) to (d) for the LCG with the same <span class="math inline">\(m\)</span>, but now with multiplier <span class="math inline">\(a = 127\)</span> and increment <span class="math inline">\(c = 4\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">lcg</span>(n, m, <span class="dv">127</span>, <span class="dv">4</span>, seed)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> samples2 <span class="sc">/</span> m</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">cos</span>(samples2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.868257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">cos</span>(samples2)) <span class="sc">/</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003899394</code></pre>
</div>
</div>
<p>This does not seem to be quite accurate to the answer to <span class="math inline">\(\sin 1 = 0.841\)</span>, and the reported RMSE to too small to account for the error.</p>
<p>However, the problem is that this LCG is not actually a uniform (pseudo)random number generator – it has period 8.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(samples2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-26-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Thus the estimator is just keeping using the same 8 points over and over again. So this is actually estimating <span class="math inline">\(\mathbb E(\cos Y)\)</span>, where <span class="math inline">\(Y\)</span> is uniform on the 8 points actually visited by the LCG. So while the correct answer is <span class="math inline">\(\mathbb EU = \sin 1 = 0.841\)</span>, this is in fact estimating <span class="math display">\[ \begin{multline}
\frac{1}{8} \bigg(\cos \frac{1}{2^{10}} + \cos \frac{131}{2^{10}} + \cos \frac{257}{2^{10}} + \cos \frac{899}{2^{10}} \\
+ \cos \frac{513}{2^{10}} + \cos \frac{643}{2^{10}} + \cos \frac{769}{2^{10}} + \cos \frac{387}{2^{10}}\bigg) = 0.868
\end{multline} \]</span> (where the numerators are the 8 values visited by the LCG), which is not the correct answer.</p>
</div>
</div>
</div>
</section>
<section id="P3-sols" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="P3-sols">Problem Sheet 3</h2>
<div class="hidden">
<p><span class="math display">\[\newcommand{\Exg}{\operatorname{\mathbb{E}}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Ind}{\mathbb{I}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\ee}{\mathrm{e}}\]</span></p>
</div>
<div class="myq">
<p><strong>1.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider a discrete random variable that takes values <span class="math inline">\(1, 2, 3, 4.5\)</span> with probabilities <span class="math inline">\(0.2, 0.2, 0.5, 0.1\)</span> respectively. Write some R code that will sample from this distribution. (Your code may use the <code>runif()</code> function, but may not use the <code>sample()</code> function.) Check that a large sample from your code really does have the correct distribution.</p>
<div class="myanswers">
<p><em>Solution.</em> There are various ways to do this. With only four outcomes, you can just write a lot of this “by hand”, in a way that wouldn’t be practical if the range were very large, but it pretty easy to write – that’s what I did.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rq1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">4.5</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  cumprob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  unif <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(unif <span class="sc">&lt;=</span> cumprob[<span class="dv">1</span>], x[<span class="dv">1</span>],</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(unif <span class="sc">&lt;=</span> cumprob[<span class="dv">2</span>], x[<span class="dv">2</span>],</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(unif <span class="sc">&lt;=</span> cumprob[<span class="dv">3</span>], x[<span class="dv">3</span>], x[<span class="dv">4</span>])))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let’s test its accuracy by drawing a bar plot of a large sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rq1</span>(n)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(samples) <span class="sc">/</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-28-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Looks good to me.</p>
</div>
</div>
<div class="myq">
<p><strong>2.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The geometric distribution <span class="math inline">\(X \sim \operatorname{Geom}(p)\)</span> represents the number of trials until the first success, where each trial succeeds independently with probability <span class="math inline">\(p\)</span>. The probability mass function of <span class="math inline">\(X\)</span> is <span class="math display">\[ p(x) = (1-p)^{x-1}p \qquad x = 1, 2, \dots. \]</span></p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Show that the cumulative distribution function <span class="math inline">\(F\)</span> of <span class="math inline">\(X\)</span> is given by <span class="math display">\[ F(x) = 1 - (1-p)^x \qquad x = 1, 2, \dots .\]</span></p>
<div class="myanswers">
<p><em>Solution.</em> I can think of two ways to do this. The first way is to just sum the probabilities, using the formula <span class="math display">\[ \sum_{z=0}^{x-1} a^z = \frac{1 - a^x}{1-a} \]</span> for the sum of a geometric progression. We have <span class="math display">\[ F(x) = \sum_{y=1}^x (1-p)^{y-1} p = p \sum_{z=0}^{x-1} (1-p)^z = p \frac{1 - (1-p)^{x}}{1 - (1-p)} = 1 - (1-p)^x , \]</span> where in the second equality where shifted the index of the sum with <span class="math inline">\(z = y-1\)</span>.</p>
<p>Alternatively (and, in my opinion, better) is to think about what the geometric distribution <em>means</em>. The geometric probability <span class="math inline">\(p(x)\)</span> is the probability the first success occurs on the <span class="math inline">\(x\)</span>th trial. So the complement of the CDF, <span class="math inline">\(1 - F(x) = \mathbb P(X &gt; x)\)</span> is the probability the first success happens <em>after</em> the <span class="math inline">\(x\)</span>th trial, which is if and only if the first <span class="math inline">\(x\)</span> trials are all failures. This is <span class="math display">\[ 1 - F(x) = \mathbb P(X &gt; x) = (1-p)^x \]</span> because each of those <span class="math inline">\(x\)</span> trials fails with probability <span class="math inline">\(1 - p\)</span>. This gives the answer.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Write down a function – either in mathematical notation or in R code – that will transform a standard uniform random variable <span class="math inline">\(U\)</span> into a geometric distribution. Try to make your function as simple as possible.</p>
<div class="myanswers">
<p><em>Solution.</em> The “dividing lines” between the segments come at the values <span class="math inline">\(u\)</span> where <span class="math inline">\(u = 1- (1-p)^x\)</span>. Actually, since we’re trying to make the function simple, we could use <span class="math inline">\(v = 1-u\)</span> (since one minus a standard uniform is still standard uniform), with dividing lines at <span class="math inline">\(v = (1-p)^x\)</span>, which corresponds to <span class="math inline">\(x = \log v / \log(1-p)\)</span>. So the segment corresponding to a uniformly distributed <span class="math inline">\(v\)</span> will correspond to this value rounded up to the next integer.</p>
<p>So we can take <span class="math inline">\(U \sim \operatorname{U}[0,1]\)</span>, and put <span class="math display">\[ X = \left\lceil \frac{\log U}{\log(1-p)} \right\rceil . \]</span></p>
<p>Let’s check this with R code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>rgeom2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  unif <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ceiling</span>(<span class="fu">log</span>(unif) <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rgeom2</span>(n, p)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(samples) <span class="sc">/</span> n, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-29-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We could alternatively check the probabilities exactly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>true <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>{<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">-</span> <span class="dv">1</span>} <span class="sc">*</span> p</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">&lt;-</span> <span class="fu">table</span>(samples)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="sc">/</span> n</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(true, emp), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1      2      3      4      5      6      7      8
true 0.3333 0.2222 0.1481 0.0988 0.0658 0.0439 0.0293 0.0195
emp  0.3334 0.2225 0.1476 0.0985 0.0659 0.0442 0.0292 0.0195</code></pre>
</div>
</div>
<p>Looks good again.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>3.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider a Cauchy random variable <span class="math inline">\(X\)</span> with probability density function <span class="math display">\[ f(x) = \frac{1}{\pi(1 + x^2)} .\]</span></p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Show that the cumulative distribution function of <span class="math inline">\(X\)</span> is <span class="math display">\[ F(x) = \frac12 + \frac{1}{\pi}\arctan x \]</span></p>
<div class="myanswers">
<p><em>Solution.</em> The CDF is <span class="math display">\[ \begin{multline}
F(x) = \int_{-\infty}^x f(y)\,\mathrm{d}y
  = \frac{1}{\pi} \int_{-\infty}^x \frac{1}{1+y^2}\,\mathrm{d}y
  = \frac{1}{\pi} \big[\arctan y\big]_{-\infty}^x \\ = \frac{1}{\pi} \bigg( \arctan x - \Big(-\frac{\pi}{2}\Big)\bigg) = \frac{1}{\pi}\arctan x + \frac12,
\end{multline}\]</span> since <span class="math inline">\(\lim_{y\to-\infty} \arctan y = -\frac{\pi}{2}\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Write down a function that will transform a standard uniform random variable <span class="math inline">\(U\)</span> into a Cauchy distribution.</p>
<div class="myanswers">
<p><em>Solution.</em> We use the inverse transform method: write <span class="math inline">\(U = F(X)\)</span> and invert. Here, we have <span class="math display">\[ U = \frac12 + \frac{1}{\pi}\arctan X .\]</span> Inverting gives <span class="math display">\[X = \tan \bigg(\pi \Big(U - \frac12\Big) \bigg) .\]</span></p>
<p>This can be interpreted as <span class="math inline">\(X = \tan\Theta\)</span> where <span class="math inline">\(\Theta\)</span> is uniform between <span class="math inline">\(-\frac{\pi}{2}\)</span> and <span class="math inline">\(\frac{\pi}{2}\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Using your answer to part (b), draw a histogram of samples from the Cauchy distribution in R.</p>
<div class="myanswers">
<p><em>Solution.</em> My function for generating samples is the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>rcauchy2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  unif <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tan</span>(pi <span class="sc">*</span> (unif <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Cauchy distribution is a very heavy-tailed distribution. So to make the histogram look sensible, I’m going to throw away the occasional very large or very small sample. If I didn’t do this, the histogram would probably just look like a single spike at 0. (You of course shouldn’t do this when performing Monte Carlo estimation – those rare very large or very small samples can be extremely important in calculations!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rcauchy2</span>(n)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>samples_rest <span class="ot">&lt;-</span> samples[<span class="fu">abs</span>(samples) <span class="sc">&lt;</span> <span class="dv">12</span>]</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samples_rest, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.33</span>), <span class="at">breaks =</span> <span class="dv">48</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">n =</span> <span class="dv">1001</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-32-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="myq">
<p><strong>4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(F\)</span> be a cumulative distribution function and <span class="math inline">\(F^{-1}\)</span> its inverse.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Prove that <span class="math inline">\(F^{-1}\)</span> is a non-decreasing function.</p>
<div class="myanswers">
<p><em>Solution.</em> We recall the definition <span class="math inline">\(F^{-1}(u) = \min \{x : F(x) \geq u\}\)</span>. As <span class="math inline">\(u\)</span> increases, the set <span class="math inline">\(A_u = \{x : F(x) \geq u \}\)</span> gets smaller – more specifically, for <span class="math inline">\(u \leq v\)</span>, we have <span class="math inline">\(A_u \subseteq A_v\)</span>. Hence the minimum of the set <span class="math inline">\(A_u\)</span> cannot be larger than the minimum of the set <span class="math inline">\(A_v\)</span>. Hence <span class="math inline">\(F^{-1}(u) = \min A_u \leq \min A_v = F^{-1}(v)\)</span>, as required.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Show that <span class="math inline">\(X = F^{-1}(U)\)</span> and <span class="math inline">\(X' = F^{-1}(1-U)\)</span> have negative (or, rather, non-positive) correlation. You may use any results from the module, provided you state them clearly.</p>
<div class="myanswers">
<p><em>Solutions.</em> The relevant result here is <a href="../lectures/L07-antithetic-2.html#thm-neg" class="quarto-xref">Theorem&nbsp;<span>7.2</span></a>. This said that if <span class="math inline">\(\phi\)</span> is an non-decreasing function, then <span class="math inline">\(\phi(U)\)</span> and <span class="math inline">\(\phi(1-U)\)</span> have covariance – and therefore correlation – less than or equal to 0. Here, we use <span class="math inline">\(F^{-1}\)</span> as the function <span class="math inline">\(\phi\)</span>.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>5.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(X \sim \operatorname{Beta}(3, 2)\)</span> be a Beta distribution with PDF <span class="math display">\[ f(x) = 12 x^2(1-x) \qquad 0 \leq x \leq 1 . \]</span> [<strong>Note:</strong> <em>An earlier version of this question wrongly had the constant at the front as</em> <span class="math inline">\(\frac{1}{12}\)</span> instead of <span class="math inline">\(12\)</span>.]</p>
<p>Show how you could sample from <span class="math inline">\(X\)</span> using envelope rejection sampling and an optimised value of the constant <span class="math inline">\(c\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> The obvious suggestion here is to take <span class="math inline">\(Y\)</span> uniformly distributed on <span class="math inline">\([0, 1]\)</span>, so <span class="math inline">\(g(x) = 1\)</span> (although you don’t have to choose that).</p>
<p>To find the optimal value of <span class="math inline">\(c\)</span>, we consider the maximum of <span class="math inline">\(f(x)\)</span>. We can find that by differentiating <span class="math display">\[ f'(x) = \frac{\mathrm{d}}{\mathrm{d}x} (12x^2 - 12x^3) = (24x - 36x^2) , \]</span> so the maximum is at <span class="math inline">\(x = \frac23\)</span>, where <span class="math inline">\(f(x) = \frac{16}{9}\)</span>. Therefore, we take <span class="math inline">\(c = \frac{16}{9}\)</span>.</p>
<p>Thus, our algorithm is to sample from a standard uniform, and then to accept with probability <span class="math display">\[ \alpha(x) = \frac{12x^2(1-x)}{\frac{16}{9}} = \frac{27}{4}\,x^2(1-x) . \]</span></p>
</div>
</div>
<div class="myq">
<p><strong>6.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider sampling from the half-normal distribution <span class="math display">\[ f(x) = \sqrt{\frac{2}{\pi}} \exp\big(-\tfrac12 x^2\big) \qquad x \geq 0 \]</span> using envelope rejection sampling with an <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span> proposal distribution <span class="math display">\[g(x) = \lambda \mathrm{e}^{-\lambda x} \qquad x \geq 0 .\]</span> You wish to design your envelope rejection sampling algorithm so that the acceptance probability is as high as possible.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;For fixed <span class="math inline">\(\lambda\)</span>, show that the optimal value of <span class="math inline">\(c\)</span> is <span class="math display">\[c = \sqrt{\frac{2}{\pi}}\,\frac{\exp(\frac12\lambda^2)}{\lambda}.\]</span></p>
<div class="myanswers">
<p><em>Solution.</em> This is very similar to <a href="../lectures/L15-envelope-1.html#exm-env-norm" class="quarto-xref">Example&nbsp;<span>15.2</span></a> in Lecture 15. We have <span class="math display">\[ \frac{f(x)}{g(x)} = \frac{\sqrt\frac{2}{\pi} \exp(\tfrac12 x^2)}{\lambda \exp(-\lambda x)} = \sqrt\frac{2}{\pi} \,\frac{\exp \big(-\tfrac12 x^2 + \lambda x\big)}{\lambda} . \]</span> We want to pick <span class="math inline">\(c\)</span> to be the maximum value of this. The maximum occurs where <span class="math inline">\(-\frac12x^2 + \lambda x\)</span> is maximised. By differentiating this and setting equal to 0, we get <span class="math inline">\(-x + \lambda = 0\)</span>, so <span class="math inline">\(x = \lambda\)</span> and <span class="math display">\[ c =  \sqrt\frac{2}{\pi} \,\frac{\exp \big(-\tfrac12 \lambda^2 + \lambda^2\big)}{\lambda} =   \sqrt\frac{2}{\pi} \,\frac{\exp \big(\tfrac12 \lambda^2\big)}{\lambda}, \]</span> as required.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Show that the optimal value of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\lambda = 1\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> Again, our goal is to choose <span class="math inline">\(\lambda\)</span> get <span class="math inline">\(c\)</span> as small as possible, since <span class="math inline">\(1/c\)</span> is the acceptance probability. Differentiating the expression from part (a) with respect to <span class="math inline">\(\lambda\)</span> gives <span class="math display">\[ \frac{\mathrm d}{\mathrm d\lambda} \,c = \sqrt\frac{2}{\pi} \frac{\exp \big(\tfrac12 \lambda^2\big)(\lambda^2 - 1)}{\lambda^2}.\]</span> This is 0 when <span class="math inline">\(\lambda^2 = 1\)</span>, and since <span class="math inline">\(\lambda \geq 0\)</span>, the only solution is <span class="math inline">\(\lambda = 1\)</span>. (This can be easily checked to be a minimum by looking at a sketch of <span class="math inline">\(c\)</span> against <span class="math inline">\(\lambda\)</span>, or differentiating twice, or just by thinking about the behaviour of <span class="math inline">\(c\)</span> as a function of <span class="math inline">\(\lambda\)</span>.)</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>7.</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>[2016 exam, Question 1]</em>&nbsp;&nbsp;In this question, we consider generating samples from the distribution with probability density function <span class="math display">\[ f_a(x) = \frac{1}{Z} \,\frac{1}{a(\cos x + 1) + x^2} \qquad x \geq 1,\]</span> where <span class="math inline">\(a\)</span> is a parameter and <span class="math display">\[Z = \int_{1}^{\infty} \frac{1}{a(\cos x + 1) + x^2}\,\mathrm{d}x \]</span> is a normalising constant.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Introducing any notation you use, state the inverse transform method for random number generation.</p>
<div class="myanswers">
<p><em>Solution.</em> Fix a cumulative distribution function (CDF) <span class="math inline">\(F(x) = \mathbb P(X \leq x)\)</span>. The inverse CDF is defined to be <span class="math inline">\(F^{-1}(u) = \max \{x : F(x) \geq u\}\)</span>. We then have that <span class="math inline">\(X = F^{-1}(U)\)</span> has CDF <span class="math inline">\(F\)</span>. We use this typically by writing <span class="math inline">\(U = F(X)\)</span> and inverting to make <span class="math inline">\(X\)</span> the subject.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;For <span class="math inline">\(a = 0\)</span>, explain how the inverse transform method can be used to generate samples with PDF <span class="math inline">\(f_0\)</span>.</p>
<div class="myanswers">
<p>For <span class="math inline">\(a = 0\)</span>, the PDF is <span class="math display">\[ f_0(x) = \frac{1}{Z} \,\frac{1}{x^2} \qquad x \geq 1 .\]</span></p>
<p>We should start by finding the normalising constant <span class="math inline">\(Z\)</span>: it’s <span class="math display">\[ Z = \int_1^\infty \frac{1}{x^2}\,\mathrm{d}x = \big[-x^{-1}\big]_1^\infty = 0 -(-1) = 1 , \]</span> so the PDF is simply <span class="math inline">\(f_0(x) = 1/x^2\)</span>.</p>
<p>Next, we want to find the CDF <span class="math inline">\(F\)</span>: it’s <span class="math display">\[ F(x) = \int_1^x f_0(y)\,\mathrm{d}y = \int_1^x \frac{1}{y^2}\,\mathrm{d}y = \big[-y^{-1}\big]_1^x = 1 - \frac{1}{x} . \]</span></p>
<p>Finally, to perform the inverse transform method, we write <span class="math inline">\(U = F(X)\)</span> and invert. We have <span class="math inline">\(U = 1 - 1/x\)</span>, and so <span class="math inline">\(X = 1/(1-U)\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Introducing any notation you use, state the envelope rejection sampling method for random number generation.</p>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;For <span class="math inline">\(a &gt; 0\)</span>, explain how the envelope rejection sampling method can be used to generate samples with PDF <span class="math inline">\(f_a\)</span>.</p>
</div>
<div class="subq">
<p><strong>(e)</strong>&nbsp;&nbsp;How does the efficiency of your method in part (d) change as the value of <span class="math inline">\(a\)</span> increases? Justify your answer.</p>
</div>
</div>
</section>
<section id="P4-sols" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="P4-sols">Problem Sheet 4</h2>
<div class="hidden">
<p><span class="math display">\[\newcommand{\Exg}{\operatorname{\mathbb{E}}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Ind}{\mathbb{I}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\ee}{\mathrm{e}}\]</span></p>
</div>
<div class="myq">
<p><strong>1.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider a Markov chain on the discrete state space <span class="math inline">\(\mathcal S = \{1, 2, \dots\}\)</span> with transition probabilities <span class="math inline">\(p(x, x+1) = p\)</span> for all <span class="math inline">\(x\)</span>, <span class="math inline">\(p(x, 1) = 1 - p\)</span> for all <span class="math inline">\(x\)</span>, and <span class="math inline">\(p(x, y) = 0\)</span> otherwise.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Calculate the two-step transition probabilities <span class="math inline">\(p^{(2)}(x, y)\)</span>. (You might start by working out what two-step transitions are even <em>possible</em>.)</p>
<div class="myanswers">
<p><em>Solution.</em> The possible paths of length two from <span class="math inline">\(x\)</span> are</p>
<ul>
<li><p><span class="math inline">\(x \to x + 1 \to x + 2\)</span>: this requires two steps up, so has probability <span class="math inline">\(p^2\)</span>.</p></li>
<li><p><span class="math inline">\(x \to x+1 \to 1\)</span>: this requires one step up then a reset, so has probability <span class="math inline">\(p(1-p)\)</span>.</p></li>
<li><p><span class="math inline">\(x \to 1 \to 2\)</span>: this requires a reset then one step up, so has probability <span class="math inline">\((1-p)p\)</span>.</p></li>
<li><p><span class="math inline">\(x \to 1 \to 1\)</span>: this requires two resets, so has probability <span class="math inline">\((1-p)^2\)</span>.</p></li>
</ul>
<p>Hence the two-step transition probabilities are <span class="math display">\[ \begin{align}
p^{(2)}(x, x+2) &amp;= p^2 \\
p^{(2)}(x, 2) &amp;= (1-p)p \\
p^{(2)}(x, 1) &amp;= p(1 - p) + (1-p)^2 = 1 - p
\end{align} \]</span> and <span class="math inline">\(p(x, y) = 0\)</span> otherwise.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Find the stationary distribution <span class="math inline">\(\pi\)</span> for the Markov chain by solving <span class="math inline">\(\pi(y) = \sum_x \pi(x) p(x,y)\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> For <span class="math inline">\(y \neq 1\)</span>, the only <span class="math inline">\(x\)</span> with <span class="math inline">\(p(x, y) \neq 0\)</span> is <span class="math inline">\(x = y-1\)</span>. So we have <span class="math inline">\(\pi(y) = \pi(y-1)\,p(y-1, y) = p\,\pi(y-1)\)</span>.</p>
<p>Hence we have <span class="math inline">\(\pi(2) = p\,\pi(1)\)</span>, <span class="math inline">\(\pi(3) = p\,\pi(2) = p^2 \pi(1)\)</span>, <span class="math inline">\(\pi(4) = p\,\pi(3) = p^3 \pi(1)\)</span>, and in general <span class="math inline">\(\pi(i) = p^{i-1}\,\pi(1)\)</span>. (This equation even holds for <span class="math inline">\(i = 1\)</span> itself.)</p>
<p>We also know that <span class="math inline">\(\pi\)</span> is a distribution, so must sum to 1. Hence <span class="math display">\[ 1 = \sum_{i=1}^\infty \pi(i) = \sum_{i=1}^\infty p^{i-1}\,\pi(1) = \pi(1) \sum_{i=1}^\infty p^{i-1} = \pi(1) \, \frac{1}{1-p} .  \]</span> Hence <span class="math inline">\(\pi(1) = 1 - p\)</span>, and <span class="math inline">\(\pi(i) = p^{i-1}(1-p)\)</span>. This is a <span class="math inline">\(\operatorname{Geom}(1-p)\)</span> distribution.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>2.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The health of a chicken each day during a bird flu pandemic is described by a simple “healthy–sick–dead” Markov chain model. The state space is <span class="math inline">\(\mathcal S = \{\text{H}, \text{S}, \text{D}\}\)</span>. The transition probabilities are <span class="math display">\[ \begin{align}
p_{\mathrm{HH}} &amp;= ? &amp; p_{\mathrm{HS}} &amp;= 0.02 &amp; p_{\mathrm{HD}} &amp;= 0.01 \\
p_{\mathrm{SH}} &amp;= 0.3 &amp; p_{\mathrm{SS}} &amp;= 0.5 &amp; p_{\mathrm{SD}} &amp;= 0.2 \\
p_{\mathrm{DH}} &amp;= ? &amp; p_{\mathrm{DS}} &amp;= ? &amp; p_{\mathrm{DD}} &amp;= 1.
\end{align} .\]</span> Fill in the three gaps (marked <span class="math inline">\(?\)</span>).</p>
<p>If a chicken is healthy on day 1, what is the probability it is still alive on <strong>(a)</strong> day 2, <strong>(b)</strong> day 3; <strong>(c)</strong> day 11; <strong>(d)</strong> day 51? (You should do parts (a) and (b) by hand, but I recommend a computer for parts (c) and (d).)</p>
<div class="myanswers">
<p><em>Solutions.</em> Because row of a transition matrix have to add up to 1, <span class="math inline">\(p_{\mathrm{HH}} = 1 - 0.02 - 0.01 = 0.97\)</span>. Because all entries also have to be non-negative, it must be that <span class="math inline">\(p_{\mathrm{DH}} = p_{\mathrm{DS}} = 0\)</span>.</p>
<p><strong>(a)</strong> One day later, on day 2, the chicken has died with probability <span class="math inline">\(p_{\mathrm{HD}} = 0.01\)</span>, and is still alive with probability <span class="math inline">\(p_{\mathrm{HH}} + p_{\mathrm{HS}} = 0.97 + 0.02 = 1 - p_{\mathrm{HD}} = 0.99\)</span>.</p>
<p><strong>(b)</strong> This requires us to calculate <span class="math inline">\(p^{(2)}_{\mathrm{HH}} + p^{(2)}_{\mathrm{HS}} = 1 - p^{(2)}_{\mathrm{HD}}\)</span>.</p>
<p>We can either do this by summing over paths of length 2 (like in Question 1(a)) or by doing the matrix multiplication. Let’s do it the matrix multiplication way this time. We have <span class="math display">\[ \mathsf P^{(2)} = \mathsf P^2 = \begin{pmatrix} 0.97 &amp; 0.02 &amp; 0.01 \\ 0.3 &amp; 0.5 &amp; 0.2 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} \begin{pmatrix} 0.97 &amp; 0.02 &amp; 0.01 \\ 0.3 &amp; 0.5 &amp; 0.2 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} = \begin{pmatrix} 0.9469 &amp; 0.0294 &amp; 0.0237 \\ 0.441 &amp; 0.256 &amp; 0.303 \\ 0 &amp; 0 &amp; 1\end{pmatrix}.\]</span></p>
<p>So the answer is <span class="math inline">\(0.9469 + 0.0294 = 1 - 0.0237 = 0.9763\)</span>.</p>
<p><strong>(c) and (d)</strong> I read the transition matrix into R as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.97</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I then used the matrix power function from <a href="#L18-markov-longrun">Lecture 18</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>matrixpow <span class="ot">&lt;-</span> <span class="cf">function</span>(M, n) {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">1</span>) <span class="fu">return</span>(M)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(M <span class="sc">%*%</span> <span class="fu">matrixpow</span>(M, n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The answers are the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>P11 <span class="ot">&lt;-</span> <span class="fu">matrixpow</span>(P, <span class="dv">11</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>P11[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> P11[<span class="dv">1</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8354785</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>P50 <span class="ot">&lt;-</span> <span class="fu">matrixpow</span>(P, <span class="dv">50</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>P50[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> P50[<span class="dv">1</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4186196</code></pre>
</div>
</div>
</div>
</div>
<div class="myq">
<p><strong>3.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider sampling from Poisson distribution with rate <span class="math inline">\(\lambda\)</span> using the random walk Metropolis algorithm on the integers.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Calculate the acceptance probabilities for this Markov chain. What proposals are always accepted with probability 1?</p>
<div class="myanswers">
<p><em>Solution.</em> The Poisson distribution has PMF <span class="math display">\[ \pi(x) = \mathrm{e}^{-\lambda} \,\frac{\lambda^x}{x!} . \]</span></p>
<p>The acceptance probability for “up one” is <span class="math display">\[ \alpha(x, x+1) = \min \left\{ \frac{\pi(x+1)}{\pi(x)} , \, 1 \right\}
= \min \left\{ \frac{\mathrm{e}^{-\lambda} \,\frac{\lambda^{x+1}}{(x+1)!}}{\mathrm{e}^{-\lambda} \,\frac{\lambda^x}{x!}} , \, 1 \right\}
= \min \left\{ \frac{\lambda}{x+1}, \, 1 \right\} . \]</span> This is 1 if the step up remains less than or equal to <span class="math inline">\(\lambda\)</span>.</p>
<p>The acceptance probability for “down one” is <span class="math display">\[ \alpha(x, x-1) = \min \left\{ \frac{\pi(x-1)}{\pi(x)} , \, 1 \right\}
= \min \left\{ \frac{\mathrm{e}^{-\lambda} \,\frac{\lambda^{x-1}}{(x-1)!}}{\mathrm{e}^{-\lambda} \,\frac{\lambda^x}{x!}} , \, 1 \right\}
= \min \left\{ \frac{x}{\lambda}, \, 1 \right\} . \]</span> This is 1 if the step down is from greater than or equal to <span class="math inline">\(\lambda\)</span>.</p>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Suggest a good initial starting point <span class="math inline">\(X_1\)</span> for your Markov chain. Why did you choose this?</p>
<div class="myanswers">
<p><em>Solution.</em> Somewhere in the middle of the distribution would be good. I would suggest the nearest integer to <span class="math inline">\(\lambda\)</span> as a pretty good place to start, but that’s not the only sensible choice.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Write some R code to run this Markov chain in the case <span class="math inline">\(\lambda = 4.5\)</span>.</p>
<div class="myanswers">
<p>This is my code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">4.5</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>acceptup   <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lambda) lambda <span class="sc">/</span> (x <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>acceptdown <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lambda) x <span class="sc">/</span> lambda</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="fu">round</span>(lambda)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>MRW <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>MRW[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># up proposal</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">acceptup</span>(MRW[i], lambda)) MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>                                     MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># down proposal</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">acceptdown</span>(MRW[i], lambda)) MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>                                       MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i]</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check if this has worked by looking at the probabilities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">table</span>(MRW)[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>] <span class="sc">/</span> n</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, lambda)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(observed, expected), <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              0      1      2      3      4      5      6      7      8      9
observed 0.0113 0.0504 0.1134 0.1701 0.1902 0.1705 0.1280 0.0821 0.0453 0.0220
expected 0.0111 0.0500 0.1125 0.1687 0.1898 0.1708 0.1281 0.0824 0.0463 0.0232
             10
observed 0.0101
expected 0.0104</code></pre>
</div>
</div>
<p>This looks like an excellent match.</p>
</div>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;Using your Markov chain, obtain an MCMC estimate of <span class="math inline">\(\operatorname{\mathbb E}X(X-1)\)</span>, where <span class="math inline">\(X \sim \operatorname{Po}(4.5)\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MRW <span class="sc">*</span> (MRW <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.07933</code></pre>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(e)</strong>&nbsp;&nbsp;<em>(Optional)</em> Calculate the correct answer, and comment on the accuracy of your estimate.</p>
<div class="myanswers">
<p><em>Solution.</em> We have <span class="math display">\[ \mathbb EX(X-1) = \sum_{x=0}^\infty x(x-1)\,\mathrm{e}^{\lambda}\,\frac{\lambda^x}{x!} =  \lambda^2\, \mathrm{e}^{-\lambda} \sum_{x=2}^\infty \frac{\lambda^{x-2}}{(x-2)!} = \lambda^2 \,\mathrm{e}^{-\lambda}\,\mathrm{e}^{\lambda} = \lambda^2 . \]</span> So the correct answer here is <span class="math inline">\(\lambda^2 = 4.5^2 = 20.25\)</span>.</p>
<p>I found my Markov chain always gets it right to the nearest integer and often gets it right to 1 decimal place (either 20.2 or 20.3). It is not quite as accurate basic Monte Carlo would be (which almost always gets 1 decimal place with a million samples, and occasionally two decimal places), but it is pretty good.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For <span class="math inline">\(-1 &lt; \alpha &lt; 1\)</span>, consider the Markov chain on <span class="math inline">\(\mathcal S = \mathbb R\)</span> given by <span class="math inline">\(X_{i+1} = \alpha X_i + Z_i\)</span>, where the <span class="math inline">\(Z_i \sim \operatorname{N}(0, 1)\)</span> are IID standard normals. (Students who have studied time series will recognise this as an AR(1) autoregressive process.)</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Write down the transition density <span class="math inline">\(p(x, y)\)</span> for this Markov chain.</p>
<div class="myanswers">
<p><em>Solution.</em> Given <span class="math inline">\(X_i = x\)</span>, we have that <span class="math inline">\(X_{i+1} = \alpha x + \operatorname{N}(0, 1) = \operatorname{N}(\alpha x, 1)\)</span>. So the transition density is <span class="math display">\[ p(x, y) = \frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-(y - \alpha x)^2/2} . \]</span></p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Find a stationary distribution for this Markov chain.</p>
<div class="myanswers">
<p><em>Solution.</em> There are some long-winded ways to do this. But I would start by guessing there’s a pretty good chance the stationary distribution will be normally distributed. So let’s guess there’s a stationary distribution <span class="math inline">\(\operatorname{N}(\mu, \sigma^2)\)</span>, and see if we can find <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> that satisfy this. (If we can’t, then our guess was wrong, and we’ll have to go back to the drawing board.)</p>
<p>If <span class="math inline">\(X \sim \operatorname{N}(\mu, \sigma^2)\)</span>, then <span class="math inline">\(\alpha X \sim \operatorname{N}(\alpha\mu, \alpha^2\sigma^2)\)</span> and <span class="math inline">\(\alpha X + Z \sim \operatorname{N}(\alpha\mu, \alpha^2\sigma^2 + 1)\)</span>. To have <span class="math inline">\(X\)</span> with the same distribution as <span class="math inline">\(\alpha X + Z\)</span>, we need <span class="math inline">\(\operatorname{N}(\mu, \sigma^2) = \operatorname{N}(\alpha\mu, \alpha^2\sigma^2 + 1)\)</span>.</p>
<p>This will hold true if the parameters are the same on bother sides. Looking at the mean parameters, we need <span class="math inline">\(\mu = \alpha\mu\)</span>, which forces <span class="math inline">\(\mu = 0\)</span>. Looking at the variance parameters, we need <span class="math inline">\(\sigma^2 = \alpha^2 \sigma^2 + 1\)</span>, so <span class="math inline">\(\sigma^2 = 1/(1 - \alpha^2)\)</span>. These satisfy the equation. So a stationary distribution is <span class="math display">\[ \operatorname{N}\bigg(0, \,\frac{1}{1 - \alpha^2}\bigg) . \]</span></p>
</div>
</div>
</div>
<div class="myq">
<p><strong>5.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(Y \sim \operatorname{N}(-3, 1)\)</span> and <span class="math inline">\(Z \sim \operatorname{N}(3,1)\)</span>. Let <span class="math inline">\(X\)</span> be a mixture distribution that equals <span class="math inline">\(Y\)</span> with probability <span class="math inline">\(\frac12\)</span> and equals <span class="math inline">\(Z\)</span> with probability <span class="math inline">\(\frac12\)</span>; in other words, if <span class="math inline">\(f\)</span> is the PDF of <span class="math inline">\(Y\)</span> and <span class="math inline">\(g\)</span> is the PDF of <span class="math inline">\(Z\)</span>, then <span class="math inline">\(\pi(x) = \frac12 f(x) + \frac12 g(x)\)</span> is the PDF of <span class="math inline">\(X\)</span>.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;Draw a graph of <span class="math inline">\(\pi\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(pdf, <span class="at">from =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">to =</span> <span class="dv">7</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">n =</span> <span class="dv">1001</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/mixgraph-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;Your intention is to sample (approximately) from <span class="math inline">\(X\)</span> using the random walk Metropolis algorithm on the state space <span class="math inline">\(\mathcal S = \mathbb R\)</span>. Explain why this could be tricky, and why a good choice of the typical stepsize <span class="math inline">\(\sigma\)</span> will be particularly important.</p>
<div class="myanswers">
<p><em>Solution.</em> We have a “bimodal” distribution, with two humps. If we’re not carefully, our random walk might get stuck for a long time in just one of the humps, without exploring the other one, which give an output that is not representative of the full distribution. In particular, if the typical step size <span class="math inline">\(\sigma\)</span> is too small, getting from one hump to the other will require a long and unlikely trek through the “low probability zone” between the two humps.</p>
<p>Hence it will be vitally important to make sure that <span class="math inline">\(\sigma\)</span> is big enough that jumps between the two humps can happen reasonably often. (Although, as ever, having the typical step size <span class="math inline">\(\sigma\)</span> too big brings it’s own problems of rejecting moves that overshoot the other hump.)</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;Write an R program that will run the random walk Metropolis algorithm with target distribution <span class="math inline">\(\pi\)</span>. Experiment with different values of the typical step size <span class="math inline">\(\sigma\)</span>. What did you discover, and what value of <span class="math inline">\(\sigma\)</span> did you find most appropriate?</p>
<div class="myanswers">
<p><em>Solution.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>twohump <span class="ot">&lt;-</span> <span class="cf">function</span>(n, stepsize, initial) {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  MC <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  MC[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    prop <span class="ot">&lt;-</span> MC[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, stepsize)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">pdf</span>(prop) <span class="sc">/</span> <span class="fu">pdf</span>(MC[i])) MC[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> prop</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> MC[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MC[i]</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(MC)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll start with stepsize 0.5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">twohump</span>(<span class="fl">1e5</span>, <span class="fl">0.1</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/hump4-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This has gone very badly – I’ve spent much more time in the left hump than the right hump. I found in general that sometimes I got lucky and got balanced humps in the histogram, but on other occasions it was even more unbalanced than the one shown above.</p>
<p>Perhaps better would be to set <span class="math inline">\(\sigma = 6\)</span>, since that is the gap between the two peaks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">twohump</span>(<span class="fl">1e5</span>, <span class="dv">6</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/hump1-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks better – the humps are pretty balanced now (although not perfectly balanced each time).</p>
<p>To be more rigorous, we could look at the autocorrelation, specifically <span class="math inline">\(1 + 2 \sum_{k=0}^{\infty} \rho(k)\)</span>, which we saw was an important figure in <a href="#L22-mcmc-error">Lecture 22</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">12</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  MC <span class="ot">&lt;-</span> <span class="fu">twohump</span>(<span class="fl">1e5</span>, trials[i], <span class="dv">0</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  results[i] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">acf</span>(MC, <span class="at">lag.max =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(trials, results, <span class="at">xlab =</span> <span class="st">"stepsize"</span>, <span class="at">ylab =</span> <span class="st">"autocorrelation calculation"</span>, <span class="at">log =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-39-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This suggests that stepsizes around about the size of 10 is the right order of magnitude. Let’s look a bit closer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">15</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  MC <span class="ot">&lt;-</span> <span class="fu">twohump</span>(<span class="fl">1e5</span>, trials[i], <span class="dv">0</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  results[i] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">acf</span>(MC, <span class="at">lag.max =</span> <span class="dv">1000</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(trials, results, <span class="at">xlab =</span> <span class="st">"stepsize"</span>, <span class="at">ylab =</span> <span class="st">"autocorrelation calculation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-40-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is a rather noisy picture – I’d have to do more and longer experiments to find out more. But I’d suggest something in the 4 to 10 range is probably best.</p>
</div>
</div>
<div class="subq">
<p><strong>(d)</strong> Estimate <span class="math inline">\(\mathbb EX\)</span> using your program. Comment on the accuracy of your estimation.</p>
<div class="myanswers">
<p>The estimate is simply</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">twohump</span>(<span class="fl">1e6</span>, <span class="dv">6</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.002129821</code></pre>
</div>
</div>
<p>The answer should be 0. I find this is usually pretty accurate – I usually get 0.0 to one decimal place, and often 0.00 to two decimal places.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>6.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Consider the Metropolis–Hastings algorithm on the state space <span class="math inline">\(\mathbb R\)</span> with target density <span class="math display">\[ \pi(x) \propto \sin^2(x) \,\exp(-|x|) . \]</span> Each of the following proposal methods gives a formula for the proposed next state <span class="math inline">\(Y_{i+1}\)</span> given the current state <span class="math inline">\(X_{i}\)</span>. For each proposal method, write down the proposal density <span class="math inline">\(r(x,y)\)</span> and calculate the acceptance probability <span class="math inline">\(\alpha(x, y)\)</span>.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;<span class="math inline">\(Y_{i+1} = X_i + Z_i\)</span>, where <span class="math inline">\(Z_i \sim \operatorname{N}(0,1)\)</span> are IID.</p>
<div class="myanswers">
<p><em>Solution</em> <span class="math inline">\({\displaystyle r(x, y) = \frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-(y-x)^2/2}}\)</span>.</p>
<p>Because this is symmetric, the acceptance probability is <span class="math display">\[ \begin{align}
\alpha(x, y) = \min \left\{ \frac{\pi(y)}{\pi(x)},\,1 \right\} &amp;= \min \left\{ \frac{\sin^2(y) \,\exp(-|y|)}{\sin^2(x) \,\exp(-|x|)},\,1 \right\} \\ &amp;= \min \left\{ \frac{\sin^2(y)}{\sin^2(x)} \,\exp(|x|-|y|),\,1 \right\} .
\end{align} \]</span></p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;<span class="math inline">\(Y_{i+1} = X_i + Z_i\)</span>, where <span class="math inline">\(Z_i \sim \operatorname{U}[-1,2]\)</span> are IID.</p>
<div class="myanswers">
<p><em>Solution</em> <span class="math inline">\(r(x, y) = \frac13\)</span> is <span class="math inline">\(x-1 \leq y \leq x+2\)</span>.</p>
<p>Now the acceptance probability. If <span class="math inline">\(x - 1 \leq y \leq x + 1\)</span>, then <span class="math inline">\(r(x,y) = r(y,x) = \frac13\)</span>. In that case, <span class="math display">\[ \alpha(x, y) =  \min \left\{ \frac{\sin^2(y)}{\sin^2(x)} \,\exp(|x|-|y|),\,1 \right\}  \]</span> again. On the other hand, if <span class="math inline">\(x + 1 &lt; y \leq x + 2\)</span>, then <span class="math inline">\(r(x, y) = \frac13\)</span> while <span class="math inline">\(r(y,x) = 0\)</span>. In this case, <span class="math inline">\(\alpha(x, y) = 0\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;<span class="math inline">\(Y_{i+1} \sim \operatorname{N}(0,1)\)</span>, independent of <span class="math inline">\(X_i\)</span>.</p>
<div class="myanswers">
<p><em>Solutions.</em> In this case, <span class="math inline">\(r(x, y)\)</span> does not depend on <span class="math inline">\(x\)</span> at all. We have simply <span class="math display">\[ r(x, y) = \frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-y^2/2} . \]</span> <span class="math display">\[ \begin{align}
\alpha(x, y) &amp;=  \min \left\{ \frac{\mathrm{e}^{-y^2/2} \,\pi(y)}{\mathrm{e}^{-x^2/2} \, \pi(x)} \right\} \\
&amp;=  \min \left\{ \frac{\mathrm{e}^{-y^2/2}}{\mathrm{e}^{-x^2/2}}\,\frac{\sin^2(y)}{\sin^2(x)} \,\exp(|x|-|y|),\,1 \right\} \\
&amp;= \min \left\{ \frac{\sin^2(y)}{\sin^2(x)} \,\exp\big(x^2/2 + |x|-y^2/2 - |y|\big),\,1 \right\}
\end{align} \]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="P5-sols" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="P5-sols">Problem Sheet 5</h2>
<div class="hidden">
<p><span class="math display">\[\newcommand{\Exg}{\operatorname{\mathbb{E}}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Ind}{\mathbb{I}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\ee}{\mathrm{e}}\]</span></p>
</div>
<div class="myq">
<p><strong>1.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Gamma distribution <span class="math inline">\(X \sim \Gamma(m, \lambda)\)</span> has PDF <span class="math display">\[ f(x) = \frac{\lambda^m}{(m-1)!} \,x^{m-1}\,\mathrm{e}^{-\lambda x} . \]</span> [<strong>Correction:</strong> <em>There was a typo in this PDF earlier.</em>] (This PDF can be evaluated with the <code>dgamma()</code> function in R.) The time between eruptions of a volcano, measured in years, is modelled as <span class="math inline">\(X \sim \Gamma(5, \theta)\)</span>, IID over eruptions, where <span class="math inline">\(\theta\)</span> is unknown. A scientist beliefs about <span class="math inline">\(\theta\)</span> are represented in a prior distribution <span class="math inline">\(\theta \sim \operatorname{Exp}(6)\)</span>.</p>
<p>The following times between eruptions are available in the historical record:</p>
<pre><code>       56.55,  2.57, 29.97, 10.27,  4.32, 17.91, 51.98,  7.06, 11.40, 54.80</code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sample from the posterior distribution for <span class="math inline">\(\theta\)</span>, using the random walk Metropolis algorithm. Explain how you chose the stepsize for your algorithm and how you checked it was a good choice.</p>
<p>Draw a histogram of the posterior distribution, and comment on how it differs from the prior.</p>
<div class="myanswers">
<p><em>Solution.</em> The posterior distribution is <span class="math display">\[ \pi(\theta \mid \mathbf x) \propto 6\mathrm{e}^{-6\theta} \times \prod_{i=1}^{10} x_i^{4} \, \mathrm{e}^{-\theta x_i} . \]</span></p>
<p>The code for the Metropolis random walk algorithm will be the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">56.55</span>,  <span class="fl">2.57</span>, <span class="fl">29.97</span>, <span class="fl">10.27</span>,  <span class="fl">4.32</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">17.91</span>, <span class="fl">51.98</span>,  <span class="fl">7.06</span>, <span class="fl">11.40</span>, <span class="fl">54.80</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) <span class="fu">dexp</span>(theta, <span class="dv">6</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>like  <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) <span class="fu">prod</span>(<span class="fu">dgamma</span>(x, <span class="dv">5</span>, theta))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>post  <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) <span class="fu">prior</span>(theta) <span class="sc">*</span> <span class="fu">like</span>(theta)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="cf">function</span>(curr, prop) <span class="fu">post</span>(prop) <span class="sc">/</span> <span class="fu">post</span>(curr)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>MRW <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>MRW[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  prop <span class="ot">&lt;-</span> MRW[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sigma)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (prop <span class="sc">&lt;</span> <span class="dv">0</span>)                             MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i]</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">accept</span>(MRW[i], prop)) MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> prop</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>                                      MRW[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> MRW[i]</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(MRW[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span>)], <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(prior, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-42-1.svg" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A little experimentation suggested <span class="math inline">\(\sigma = 0.2\)</span> worked about right – <span class="math inline">\(\sigma = 0.5\)</span> rejected too many changes. With my initial start point of 1, I found a short burn-in period was necessary, so my histogram starts with the 100th step of the random walk. (I could have just started from 0.2 instead, I suppose.)</p>
<p>We see that while the prior though any number between 0 and <span class="math inline">\(\tfrac12\)</span>, maybe even more, was plausible for <span class="math inline">\(\theta\)</span>, we can see the prior has become concentrated in the interval <span class="math inline">\([0.11, 0.32]\)</span> or so, with values around 0.2 the most common. The posterior variance is much smaller than the prior, so we have gained certainty from the results.</p>
</div>
</div>
<div class="myq">
<p><strong>2.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>[2019 exam, Question 4]</em></p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;&nbsp;Introducing any notation you use, state the Metropolis–Hastings algorithm for discrete state space, and explain the purpose of this algorithm.</p>
<div class="myanswers">
<p><em>Solution.</em> The Metropolis–Hastings algorithm is a method to sample from a distribution <span class="math inline">\(\pi\)</span> on a discrete space <span class="math inline">\(\mathcal S\)</span> by setting up a Markov chain <span class="math inline">\((X_i)\)</span> on <span class="math inline">\(\mathcal S\)</span> with stationary distribution <span class="math inline">\(\pi\)</span>.</p>
<p>Suppose the Markov chain is at <span class="math inline">\(X_i = x\)</span>. The Metropolis–Hastings algorithm proposes a move to <span class="math inline">\(y\)</span> with probability <span class="math inline">\(r(x, y)\)</span>, where <span class="math inline">\(\mathsf R = (r(x, y))\)</span> is the transition matrix for an irreducible Markov chain on <span class="math inline">\(\mathcal S\)</span>. This move is accepted with probability <span class="math display">\[ \alpha(x, y) = \min \left\{ \frac{\pi(y)\,r(y,x)}{\pi(x)\,r(x,y)},\, 1\right\} , \]</span> meaning that <span class="math inline">\(X_{i+1} = y\)</span>, or rejected otherwise, meaning that <span class="math inline">\(X_{i+1} = X_i = x\)</span>.</p>
<p>After being run for a large number of steps (possibly with a burn-in period), the values <span class="math inline">\(X_i\)</span> should be approximately distributed like <span class="math inline">\(\pi\)</span>.</p>
</div>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;&nbsp;Using the Metropolis–Hastings algorithm, find a Markov chain with state space <span class="math inline">\(\mathbb N = \{1, 2, 3, \dots\}\)</span> that has stationary distribution <span class="math inline">\(\mathbb P(X_n = x) = 2^{-x}\)</span> for <span class="math inline">\(x \in \mathbb N\)</span>.</p>
<div class="myanswers">
<p><em>Solution.</em> Although this isn’t the only way, I will use <span class="math inline">\(\mathsf R\)</span> to be the transition matrix of the simple symmetric random walk on <span class="math inline">\(\mathbf Z\)</span>. Because this is symmetric, the acceptance probabilities are <span class="math display">\[ \begin{align}
\alpha(x, x+1) &amp;= \min \left\{ \frac{\pi(x+1)}{\pi(x)},\, 1 \right\} = \min\big\{\tfrac12,\, 1\big\} = \tfrac 12 \\
\alpha(x, x-1) &amp;= \min \left\{ \frac{\pi(x-1)}{\pi(x)},\, 1 \right\} = \min\{2,\, 1\} = 1,
\end{align} \]</span> except that <span class="math inline">\(\alpha(1, 0) = 1\)</span>.</p>
<p>I’ll choose the starting point <span class="math inline">\(X = 1\)</span>. From here, the Markov chain repeatedly proposes a move up 1 with probability <span class="math inline">\(\tfrac12\)</span>, which is accepted with probability <span class="math inline">\(\tfrac12\)</span>, or a move down 1 with probability <span class="math inline">\(\tfrac12\)</span>, which is always accepted – except for a move from 1 down to 0 which is always rejected.</p>
</div>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;&nbsp;In a Bayesian setting, assume we have observations <span class="math inline">\(Z_1, X_2, \dots, Z_n\)</span> from an <span class="math inline">\(\operatorname{N}(0, \sigma^2)\)</span> distribution, where the prior distribution for <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(\operatorname{Exp}(1)\)</span>. Using the Metropolis–Hastings algorithm, describe in detail a method for sampling from the posterior distribution of <span class="math inline">\(\sigma^2\)</span>.</p>
<div class="myanswers">
<p><em>Solution</em> The posterior distribution is given by <span class="math display">\[ \begin{align}
\pi(\sigma^2 \mid \mathbf Z) &amp;\propto \pi(\sigma^2) \prod_{i=1}^n f(z_i \mid \sigma^2) \\
  &amp;= \mathrm{e}^{-\sigma^2} \prod_{i=1}^n \frac{1}{\sqrt{\sigma^2}} \,\exp\left(- \frac{Z_i^2}{2\sigma^2} \right) \\
  &amp;=  \mathrm{e}^{-\sigma^2} \,\sigma^{-n/2} \,\exp\left(-\frac{1}{2\sigma^2} \sum_{i=1}^n Z_i^2 \right) .
\end{align} \]</span></p>
<p>I will choose as the Markov chain a symmetric Gaussian random walk on <span class="math inline">\(\mathbb R\)</span>, meaning that the Markov chain is <span class="math inline">\(X_{i+1} = X_i + \mathrm{N}(0, s^2)\)</span>. (The special case is known as the random walk Metropolis algorithm in continuous space.) Because this is symmetric, the acceptance probability is <span class="math display">\[ \alpha(x, y) = \min \left\{ \frac{ \pi(x \mid \mathbf Z)}{\pi(y \mid \mathbf Z)},\,1\right\} , \]</span> for <span class="math inline">\(y \geq 0\)</span>, where the constant of proportionality in the <span class="math inline">\(\pi\)</span>s cancel out, of <span class="math inline">\(\alpha(x, y) = 0\)</span> for <span class="math inline">\(y &lt; 0\)</span>.</p>
<p>I would suggest starting from <span class="math inline">\(X_1\)</span> between <span class="math inline">\(1\)</span> (the prior variance) and the sample variance of the <span class="math inline">\(Z_i\)</span> (the posterior variance in the large sample limit <span class="math inline">\(n \to \infty\)</span>). I would suggest choosing the step size <span class="math inline">\(s\)</span> by experiment, with smaller <span class="math inline">\(s\)</span> for large <span class="math inline">\(n\)</span>, and vice versa.</p>
</div>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;&nbsp;Let the set <span class="math inline">\(A \subset \mathbb R^2\)</span> be given by <span class="math display">\[
A = \big([0,3]\times[0,1]\big) \cup \big([0,1]\times [4,5]\big)
\cup \big([4,5]\times[0,1]\big) \cup \big([4,5] \times [3,5]\big) .
\]</span> Consider the Metropolis–Hastings algorithm on <span class="math inline">\(\mathbb R^2\)</span> with target density <span class="math display">\[ \pi(\mathbf x) = \begin{cases} \frac17 &amp; \text{if }\mathbf x \in A \\
0 &amp; \text{otherwise} \end{cases} \]</span> for all <span class="math inline">\(x \in \mathbb R^2\)</span>, and where the proposals <span class="math inline">\(\mathbf Y_{i+1}\)</span> are chosen uniformly distributed on a disk of radius <span class="math inline">\(r\)</span> around the previous state – that is, <span class="math display">\[ Y_{j+1} \sim \operatorname{U} \Big(\big\{ \mathbf y \in \mathbb R^2 : |\mathbf y - \mathbf X_i | \leq r \big\}\Big) . \]</span> Assume the algorithm starts at <span class="math inline">\(\mathbf X_1 = (0.5, 0.5)\)</span>.</p>
<p><strong>i.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For every <span class="math inline">\(r &gt; 0\)</span>, determine the stationary distribution of the resulting Markov chain.</p>
<p><strong>ii.</strong>&nbsp;&nbsp;&nbsp;&nbsp;For what values of <span class="math inline">\(r\)</span> does the algorithm work correctly?</p>
<div class="myanswers">
<p><em>Solution.</em> To see what’s going on where, we need to draw a picture of the set <span class="math inline">\(A\)</span>.</p>
<p>The question is: for what <span class="math inline">\(r\)</span> will it be possible to jump between the different blocks. We start from <span class="math inline">\((0.5, 0.5)\)</span> which is in the bottom-left block. To jump from bottom-left to bottom-right, we need <span class="math inline">\(r &gt; 1\)</span>. To jump from bottom-right to top-right, we need <span class="math inline">\(r &gt; 2\)</span>. To jump from bottom-left to top-left, we need <span class="math inline">\(r &gt; 3\)</span>.</p>
<p><strong>(i)</strong> The distribution is uniform, so as long as the Markov chain can <em>reach</em> an area, the stationary distribution will be uniform there. So the stationary distribution is uniform on the following sets:</p>
<ul>
<li><p><span class="math inline">\(0 &lt; r \leq 1\)</span>: <span class="math inline">\(\big([0,3]\times[0,1]\big)\)</span></p></li>
<li><p><span class="math inline">\(1 &lt; r \leq 2\)</span>: <span class="math inline">\(\big([0,3]\times[0,1]\big) \cup \big([4,5]\times[0,1]\big)\)</span></p></li>
<li><p><span class="math inline">\(2 &lt; r \leq 3\)</span>: <span class="math inline">\(\big([0,3]\times[0,1]\big) \cup \big([4,5]\times[0,1]\big) \cup \big([4,5] \times [3,5]\big)\)</span></p></li>
<li><p><span class="math inline">\(r &gt; 3\)</span>: <span class="math inline">\(A\)</span></p></li>
</ul>
<p>(If <span class="math inline">\(r\)</span> is only <em>just</em> above the boundary, convergence to the stationary distribution may be extremely slow.)</p>
<p><strong>(ii)</strong> The stationary distribution is the desired distribution for <span class="math inline">\(r &gt; 3\)</span>, which is the values for which the algorithm technically “works”, as <span class="math inline">\(n \to \infty\)</span>. To work “well”, <span class="math inline">\(r\)</span> will need to be comfortably bigger than 3 (so that movement to and from the top-left is reasonably common) while not being so huge that most steps are to ridiculously far away.</p>
</div>
</div>
</div>
<div class="myq">
<p><strong>3.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>[2017 exam, Question 5]</em></p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;&nbsp;Give the definition of a Markov chain with state space <span class="math inline">\(\mathcal S\)</span>.</p>
<p>Let <span class="math inline">\((Z_i)\)</span> be a sequence of IID random variables whose distribution is known. Consider the stochastic processes <span class="math inline">\((U_i)\)</span>, <span class="math inline">\((V_i)\)</span>, <span class="math inline">\((W_i)\)</span> defined by <span class="math display">\[ \begin{align}
U_i &amp;= Z_1 + Z_2 + \cdots + Z_i \\
V_i &amp;= \frac{1}{i} (Z_1 + Z_2 + \cdots + Z_i) \\
W_i &amp;= \max \{Z_j : 1 \leq j \leq i-1\} + Z_i
\end{align} \]</span> for <span class="math inline">\(i = 1, 2, \dots\)</span>. Which of these processes are Markov chains? Justify your answers.</p>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;&nbsp;Defining any notation you use, state the random walk Metropolis algorithm. What is the purpose of this algorithm?</p>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;&nbsp;Use the Metropolis–Hastings algorithm to define a Markov chain <span class="math inline">\((X_n)\)</span> on <span class="math inline">\(\mathcal S = \{0, 1, 2, \dots \}\)</span> whose stationary distribution is the Poisson distribution <span class="math inline">\(\pi(x) = \mathrm{e}^{-\lambda} \lambda^x/x!\)</span>.</p>
</div>
<div class="subq">
<p><strong>(d)</strong>&nbsp;&nbsp;&nbsp;Let <span class="math inline">\((X_i)\)</span> be a Markov chain with values in <span class="math inline">\(\mathbb R\)</span> and stationary distribution <span class="math inline">\(\pi\)</span>. Consider the estimator <span class="math display">\[\widehat{\theta}_n^{\mathrm{MCMC}} = \frac{1}{n} \sum_{i=1}^n \phi(X_i)  \]</span> for <span class="math inline">\(\theta = \operatorname{\mathbb E}(\phi(X))\)</span> for <span class="math inline">\(X\)</span> having PDF <span class="math inline">\(\pi\)</span>. Assuming <span class="math inline">\(X_1\)</span> has PDF <span class="math inline">\(\pi\)</span>, derive the result <span class="math display">\[ \operatorname{Var} \big(\widehat{\theta}_n^{\mathrm{MCMC}}\big) \approx \frac{\operatorname{Var}(\phi(X))}{n} \left(1 + 2 \sum_{i=2}^\infty \operatorname{Corr}\big(\phi(X_1),\phi(X_i)\big) \right) . \]</span></p>
</div>
<div class="myq">
<p><strong>4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let <span class="math inline">\(\mathbf X = (X_1, \dots, X_n)\)</span> be IID samples from a random variable <span class="math inline">\(X\)</span> with cumulative distribution function <span class="math inline">\(F\)</span>. Let <span class="math inline">\(F^*\)</span> be the empirical cumulative distribution function of the samples <span class="math inline">\(\mathbf X\)</span>.</p>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;&nbsp;For fixed <span class="math inline">\(x\)</span>, show that <span class="math inline">\(\operatorname{\mathbb E}F^*(x) = F(x)\)</span>.</p>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;&nbsp;For fixed <span class="math inline">\(x\)</span>, show that <span class="math inline">\(\operatorname{Var}\big(F^*(x)\big) = \displaystyle\frac{1}{n}F(x)\big(1 - F(x)\big)\)</span>.</p>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;&nbsp;For fixed <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> with <span class="math inline">\(y &gt; x\)</span>, find <span class="math inline">\(\operatorname{Cov}\big(F^*(y), F^*(x)\big)\)</span>.</p>
</div>
</div>
<div class="myq">
<p><strong>5.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A random variable <span class="math inline">\(X\)</span> has bounded support, and a statistician wishes to estimate <span class="math inline">\(\theta = \max X\)</span>, the maximum value <span class="math inline">\(X\)</span> can take. The statistician has access to 24 IID samples <span class="math inline">\(X_1, X_2, \dots, X_{24}\)</span> from this random variable which can be read into R as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>   samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">12.40</span>,  <span class="fl">2.99</span>, <span class="fl">14.79</span>,  <span class="fl">3.59</span>, <span class="fl">24.92</span>,  <span class="fl">4.11</span>,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>             <span class="fl">22.68</span>, <span class="fl">28.30</span>,  <span class="fl">0.90</span>,  <span class="fl">8.84</span>, <span class="fl">24.17</span>, <span class="fl">31.31</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>             <span class="fl">12.97</span>, <span class="fl">12.43</span>, <span class="fl">20.34</span>, <span class="fl">14.75</span>, <span class="fl">20.61</span>, <span class="fl">10.93</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>             <span class="fl">17.59</span>, <span class="fl">30.88</span>, <span class="fl">28.13</span>,  <span class="fl">0.83</span>, <span class="fl">17.43</span>, <span class="fl">20.78</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="subq">
<p><strong>(a)</strong>&nbsp;&nbsp;&nbsp;Explain why the plug-in estimator is <span class="math inline">\(\theta^* = \max \{X_j : j = 1, \dots, 24\}\)</span>, and find the <span class="math inline">\(\theta^*\)</span> for this data.</p>
</div>
<div class="subq">
<p><strong>(b)</strong>&nbsp;&nbsp;&nbsp;Use the bootstrap to estimate the bias of the plug-in estimator.</p>
</div>
<div class="subq">
<p><strong>(c)</strong>&nbsp;&nbsp;&nbsp;Improve the plug-in estimator by using your estimation of the bias to (approximately) “de-bias” the plug-in estimate.</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mpaldridge\.github\.io\/math5835\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../coursework/coursework.html" class="pagination-link" aria-label="Computational coursework">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Computational coursework</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>